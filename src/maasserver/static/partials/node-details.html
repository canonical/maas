<div data-ng-if="!loaded">
    <header class="p-strip--light is-shallow is-bordered page-header">
        <div class="row">
            <h1 class="page-header__title">Loading...</h1>
        </div>
    </header>
</div>
<div data-ng-if="loaded">
    <header sticky use-placeholder="true" media-query="min-width: 769px" class="p-strip--light is-shallow page-header u-no-padding--bottom">
        <div class="row">
            <div class="col-8">
                <h1 class="page-header__title">
                    <span contenteditable="true"
                        data-ng-class="{ editable: canEdit(), 'is-error': editHeaderInvalid(), editmode: header.editing }"
                        data-ng-show="canEdit()"
                        data-ng-model="header.hostname.value"
                        data-ng-disabled="!canEdit()"
                        data-maas-editing="editHeader()"></span>
                    <span ng-click="editHeaderDomain()" data-ng-show="!canEdit()">{$ header.hostname.value $}</span>
                    <span class="page-header__title-dot u-no-margin--top ng-hide" data-ng-show="header.editing || header.editing_domain">.</span>
                    <select class="page-header__title-domain ng-hide"
                        data-ng-show="header.editing || header.editing_domain"
                        data-ng-model="header.domain.selected"
                        data-ng-options="domain as domain.name for domain in header.domain.options">
                    </select>
                </h1>
                <button class="p-button--base u-no-margin--top ng-hide"
                    data-ng-show="header.editing || header.editing_domain"
                    data-ng-click="cancelEditHeader()">Cancel</button>
                <button class="p-button--positive ng-hide"
                    data-ng-show="header.editing || header.editing_domain"
                    data-ng-disabled="editHeaderInvalid()"
                    data-ng-click="saveEditHeader()">Save</button>

                <!-- XXX ricgard 2016-06-16 - Need to add e2e test. -->
                <div class="page-header__status u-no-margin--top" data-ng-if="!isController && !isDevice && !header.editing">
                    <ul class="p-inline-list u-no-margin--top">
                        <li class="p-inline-list__item">{$ node.status $}</li>
                        <li class="p-inline-list__item">
                            <i class="p-icon--power-{$ getPowerStateClass() $}"></i> {$ getPowerStateText() $}
                        </li>
                        <li class="p-inline-list__item">
                            <button class="p-button--base" data-ng-show="canCheckPowerState()" data-ng-click="checkPowerState()">check now</button>
                        </li>
                    </ul>
                </div>
            </div>

            <div class="col-4">
                <!-- XXX ricgard 2016-06-16 - Need to add e2e test. -->
                <div class="u-align--right" data-ng-show="!header.editing && action.availableOptions.length">
                    <div data-maas-cta="action.availableOptions"
                        data-ng-model="action.option"
                        data-ng-change="actionOptionChanged()">
                    </div>
                </div>
            </div>
        </div>
        <!-- XXX blake_r 2015-02-19 - Need to add e2e test. -->
        <div class="page-header__dropdown" data-ng-class="{ 'u-hide': !action.option }">
            <hr />
            <div class="row ng-hide" data-ng-if="!isDevice && !node.dhcp_on">
                <div class="page-header__section col-12">
                    <p class="page-header__message"><i class="p-icon--warning">Warning:</i> MAAS is not providing DHCP.</p>
                </div>
            </div>
            <div class="row ng-hide" data-ng-hide="isActionError() || isDeployError() || isSSHKeyError() || hasActionPowerError(action.option.name)">
                <!-- XXX blake_r 2015-02-19 - Need to add e2e test. -->
                <div class="page-header__section">
                    <form class="p-form">
                        <div class="row">
                            <div class="col-8">
                                <div class="ng-hide" data-ng-show="action.option.name === 'commission' || action.option.name === 'test'">
                                    <div class="p-form__group">
                                        <input id="enableSSH" type="checkbox"
                                            data-ng-model="commissionOptions.enableSSH">
                                        <label class="u-no-margin--top" for="enableSSH">Allow SSH access and prevent machine from powering off</label>
                                    </div>
                                </div>
                                <div class="ng-hide" data-ng-show="action.option.name === 'commission'">
                                    <div class="p-form__group">
                                        <label class="p-form__label" for="skipNetworking">Retain network configuration</label>
                                        <div class="p-form__control u-clearfix">
                                            <input id="skipNetworking" type="checkbox"
                                                data-ng-model="commissionOptions.skipNetworking">
                                        </div>
                                    </div>
                                    <div class="p-form__group">
                                        <label class="p-form__label" for="skipStorage">Retain storage configuration</label>
                                        <div class="p-form__control u-clearfix">
                                            <input id="skipStorage" type="checkbox"
                                                data-ng-model="commissionOptions.skipStorage">
                                        </div>
                                    </div>
                                </div>
                                <div class="ng-hide" data-ng-show="action.option.name === 'deploy'">
                                    <div class="p-form__group">
                                        <label class="p-form__label">Choose your image</label>
                                        <div class="p-form__control u-clearfix">
                                            <div data-maas-os-select="osinfo" data-ng-model="osSelection"></div>
                                        </div>
                                    </div>
                                </div>
                                <div class="p-form__fieldset" data-ng-if="action.option.name === 'release'">
                                    <div class="p-form__group">
                                        <div data-maas-release-options="releaseOptions"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-4">
                                <div class="page-header__controls" data-ng-if="action.option.name !== 'commission' && action.option.name !== 'test'">
                                    <button class="p-button--base" data-ng-click="actionCancel()">Cancel</button>
                                    <button class="p-button--neutral u-no-margin--top" data-ng-class="action.option.name === 'delete' ? 'p-button--negative' : 'p-button--positive'" data-ng-click="actionGo('nodes')" data-ng-hide="hasActionsFailed('nodes')">
                                        <span data-ng-if="action.option.name === 'acquire'">Acquire {$ type_name $}</span>
                                        <span data-ng-if="action.option.name === 'deploy'">Deploy {$ type_name $}</span>
                                        <span data-ng-if="action.option.name === 'release'">Release {$ type_name $}</span>
                                        <span data-ng-if="action.option.name === 'set-zone'">Set zone for {$ type_name $}</span>
                                        <span data-ng-if="action.option.name === 'on'">Power on {$ type_name $}</span>
                                        <span data-ng-if="action.option.name === 'off'">Power off {$ type_name $}</span>
                                        <span data-ng-if="action.option.name === 'abort'">Abort action on {$ type_name $}</span>
                                        <span data-ng-if="action.option.name === 'rescue-mode'">Rescue {$ type_name $}</span>
                                        <span data-ng-if="action.option.name === 'exit-rescue-mode'">Exit rescue mode</span>
                                        <span data-ng-if="action.option.name === 'mark-broken'">Mark {$ type_name $}</span>
                                        <span data-ng-if="action.option.name === 'mark-fixed'">Mark {$ type_name $}</span>
                                        <span data-ng-if="action.option.name === 'override-failed-testing'">Override failed testing</span>
                                        <span data-ng-if="action.option.name === 'lock'">Lock {$ type_name $}</span>
                                        <span data-ng-if="action.option.name === 'unlock'">Unlock {$ type_name $}</span>
                                        <span data-ng-if="action.option.name === 'delete'">Delete {$ type_name $}</span>
                                        <span data-ng-if="action.option.name === 'import-images'">Import images</span>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
            <div class="row ng-hide" data-ng-hide="isActionError() || isDeployError() || isSSHKeyError() || hasActionPowerError(action.option.name) || action.option.name !== 'commission'" data-ng-if="hasCustomCommissioningScripts()">
                <div class="page-header__section">
                    <form class="p-form p-form--stacked">
                        <div class="col-8">
                            <div class="p-form__group">
                                <label for="commissioning-scripts">Additional commissioning scripts</label>
                                <span id="commissioning-scripts" data-maas-script-select="script" data-script-type="0" data-ng-model="commissioningSelection"></span>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
            <div class="row u-no-margin--top ng-hide" data-ng-hide="isActionError() || isDeployError() || isSSHKeyError() || hasActionPowerError(action.option.name) || (action.option.name !== 'commission' && action.option.name !== 'test')">
                <hr />
                <div class="page-header__section">
                    <form class="p-form">
                        <div class="col-8">
                            <div class="p-form__group">
                                <label>Hardware tests</label>
                                <span id="testing-scripts" data-maas-script-select="script" data-script-type="2" data-ng-model="testSelection" class="tags--inline"></span>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
            <div class="u-no-margin--top row ng-hide"  data-ng-hide="isActionError() || isDeployError() || isSSHKeyError() || hasActionPowerError(action.option.name)" data-ng-if="action.option.name === 'commission' || action.option.name === 'test'">
                <hr />
                <div class="page-header__section col-12">
                    <form class="p-form">
                        <div class="u-align--right">
                            <button class="p-button--base" data-ng-click="actionCancel()">Cancel</button>
                            <button class="u-no-margin--top" data-ng-class="action.option.name === 'delete' ? 'p-button--negative' : 'p-button--positive'" data-ng-click="actionGo('nodes')" data-ng-hide="hasActionsFailed('nodes')">
                                <span data-ng-if="action.option.name === 'commission'">Commission {$ type_name $}</span>
                                <span data-ng-if="action.option.name === 'test'">Test {$ type_name $}</span>
                            </button>
                        </div>
                    </form>
                </div>
            </div>
            <div class="row ng-hide" data-ng-show="isActionError()">
                <!-- XXX blake_r 2015-02-19 - Need to add e2e test. -->
                <div class="col-12">
                    <p>
                        <i class="p-icon--error">Error:</i> Node failed to be {$ action.option.sentence $}, because of the following error: {$ action.error $}
                    </p>
                    <div class="u-align--right">
                        <button class="p-button--base" data-ng-click="actionCancel()">Cancel</button>
                        <button class="p-button--neutral" data-ng-click="actionGo()">Retry</button>
                    </div>
                </div>
            </div>
            <div class="row ng-hide" data-ng-show="isDeployError()">
                <!-- XXX blake_r 2015-02-19 - Need to add e2e test. -->
                <div class="col-8">
                    <p>
                        <i class="p-icon--error">Error:</i> Node cannot be {$ action.option.sentence $}, because the required boot images have not been imported. To import boot images, visit the <a href="images/">images page</a>.
                    </p>
                </div>
                <div class="col-4 u-align--right">
                    <button class="p-button--base" data-ng-click="actionCancel()">Cancel</button>
                </div>
            </div>
            <div class="row ng-hide" data-ng-show="hasActionPowerError(action.option.name)">
                <div class="col-8">
                    <p>
                        <i class="p-icon--error">Error:</i> Node cannot be {$ action.option.sentence $}, because power control software for the
                        node is missing from its rack controller. To proceed, install the
                        {$ getPowerErrors() $} on the rack controller.
                    </p>
                </div>
                <div class="col-4 u-align--right">
                    <button class="p-button--base" data-ng-click="actionCancel()">Cancel</button>
                </div>
            </div>
            <div class="row ng-hide" data-ng-show="!isDeployError() && isSSHKeyError()">
                <div class="col-12">
                    <p>
                        <i class="p-icon--error">Error:</i> Node cannot be {$ action.option.sentence $}, because an SSH key has not been added to your account. To add an SSH key, visit <a href="account/prefs/">your account page</a>.
                    </p>
                    <div class="u-align--right">
                        <button class="p-button--base" data-ng-click="actionCancel()">Cancel</button>
                    </div>
                </div>
            </div>
        </div>

        <nav class="p-tabs">
            <ul class="p-tabs__list" role="tablist" data-ng-class="{ 'u-hide': action.option }">
                <li class="p-tabs__item" role="presentation">
                    <a role="tab" class="p-tabs__link" data-ng-if="!isController && !isDevice"
                        data-ng-class="{ 'is-active': section.area === 'summary'}"
                        data-ng-click="section.area = 'summary'">Machine summary</a>
                </li>
                <li class="p-tabs__item" role="presentation">
                    <a role="tab" class="p-tabs__link" data-ng-if="isController"
                        data-ng-class="{ 'is-active': section.area === 'summary'}"
                        data-ng-click="section.area = 'summary'">Controller summary</a>
                </li>
                <li class="p-tabs__item" role="presentation">
                    <a role="tab" class="p-tabs__link" data-ng-if="isDevice"
                        data-ng-class="{ 'is-active': section.area === 'summary'}"
                        data-ng-click="section.area = 'summary'">Device summary</a>
                </li>
                <li class="p-tabs__item" role="presentation">
                    <a role="tab" class="p-tabs__link" data-ng-if="!isController && devices.length"
                        data-ng-class="{ 'is-active': section.area === 'containers'}"
                        data-ng-click="section.area = 'containers'">Containers</a>
                </li>
                <li class="p-tabs__item" role="presentation">
                    <a role="tab" class="p-tabs__link" data-ng-if="isController"
                        data-ng-class="{ 'is-active': section.area === 'vlans'}"
                        data-ng-click="section.area = 'vlans'">VLANs</a>
                </li>
                <li class="p-tabs__item" role="presentation">
                    <a role="tab" class="p-tabs__link"
                        data-ng-class="{ 'is-active': section.area === 'interfaces'}"
                        data-ng-click="section.area = 'interfaces'">Interfaces</a>
                </li>
                <li class="p-tabs__item" role="presentation">
                    <a role="tab" class="p-tabs__link" data-ng-if="!isDevice && !(isController && node.status === 'New')"
                        data-ng-class="{ 'is-active': section.area === 'storage'}"
                        data-ng-click="section.area = 'storage'">Storage</a>
                </li>
                <li class="p-tabs__item" role="presentation">
                    <a role="tab" class="p-tabs__link" data-ng-if="node.commissioning_script_count > 0"
                        data-ng-class="{ 'is-active': section.area === 'commissioning'}"
                        data-ng-click="section.area = 'commissioning'"><span data-maas-script-status="script-status" data-script-status="node.commissioning_status"></span> Commissioning</a>
                </li>
                <li class="p-tabs__item" role="presentation">
                    <a role="tab" class="p-tabs__link" data-ng-if="node.testing_script_count > 0"
                        data-ng-class="{ 'is-active': section.area === 'testing'}"
                        data-ng-click="section.area = 'testing'"><span data-maas-script-status="script-status" data-script-status="node.testing_status"></span> Hardware tests</a>
                </li>
                <li class="p-tabs__item" role="presentation">
                    <a role="tab" class="p-tabs__link" data-ng-if="machine_output.viewable"
                        data-ng-class="{ 'is-active': section.area === 'logs'}"
                        data-ng-click="section.area = 'logs'"><span data-maas-script-status="script-status" data-script-status="node.installation_status" data-ng-if="node.installation_results.length > 0"></span> Logs</a>
                </li>
                <li class="p-tabs__item" role="presentation">
                    <a role="tab" class="p-tabs__link" data-ng-if="!isDevice"
                        data-ng-class="{ 'is-active': section.area === 'events'}"
                        data-ng-click="section.area = 'events'">Events</a>
                </li>
                <li class="p-tabs__item" role="presentation">
                    <a role="tab" class="p-tabs__link" data-ng-if="isSuperUser()"
                        data-ng-class="{ 'is-active': section.area === 'configuration'}"
                        data-ng-click="section.area = 'configuration'">Configuration</a>
                </li>
            </ul>
        </nav>
    </header>

    <section class="p-strip is-shallow" data-ng-if="section.area === 'summary'">
      <div class="row">
        <div data-ng-if="isSuperUser()">
            <div class="p-notification--negative"
                data-ng-if="!isController && !isDevice && !isRackControllerConnected()">
                <p class="p-notification__response">
                    <span class="p-notification__status">Error:</span> Editing is currently disabled because no rack controller is currently connected to the region.
                </p>
            </div>
            <div class="p-notification--negative"
                data-ng-if="!isController && !isDevice && hasInvalidArchitecture() && isRackControllerConnected() && hasUsableArchitectures()">
                <p class="p-notification__response">
                    <span class="p-notification__status">Error:</span> This machine currently has an invalid architecture. Update the architecture of this machine to make it deployable.
                </p>
            </div>
            <div class="p-notification--negative"
                data-ng-if="!isController && !isDevice && hasInvalidArchitecture() && isRackControllerConnected() && !hasUsableArchitectures()">
                <p class="p-notification__response">
                    <span class="p-notification__status">Error:</span> No boot images have been imported for a valid architecture to be selected. Visit the <a href="images">images page</a> to start the import process.
                </p>
            </div>
        </div>
        <div class="p-notification" data-ng-if="!isDevice && !(isController && node.status === 'New') && node.cpu_count == 0">
            <p class="p-notification__response">
                Commission the machine to get CPU, Memory and Storage information.
            </p>
        </div>
        <div class="p-notification--caution" data-ng-if="showFailedTestWarning()">
            <p class="p-notification__response">
                <span class="p-notification__status">Warning:</span> Machine has failed tests; use with caution!
            </p>
        </div>
    </div>
    <div class="p-strip is-shallow">
        <div class="row u-equal-height" data-ng-if="isDevice">
          <div class="col-4 p-card--highlighted action-card action-card--positionable u-border--solid">
            <div maas-card-loader="device"></div>
          </div>
          <div class="col-4 p-card--highlighted action-card action-card--positionable u-border--solid">
            <div maas-card-loader="tags"></div>
          </div>
        </div>
        <div class="row u-equal-height" data-ng-if="node.node_type == 2">
          <div class="col-4 p-card--highlighted action-card u-border--solid">
            <div maas-card-loader="services"></div>
          </div>
          <div class="col-4 p-card--highlighted action-card action-card--positionable u-border--solid">
            <div maas-card-loader="images"></div>
          </div>
          <div class="col-4 p-card--highlighted action-card action-card--positionable u-border--solid">
            <div maas-card-loader="controller"></div>
          </div>
        </div>
        <div class="row u-equal-height" data-ng-if="node.node_type == 2">
          <div class="col-4 p-card--highlighted action-card action-card--positionable u-border--solid" data-ng-class="{ 'is-error': node.cpu_test_status === 3 }">
            <div maas-card-loader="cpu"></div>
          </div>
          <div class="col-4 p-card--highlighted action-card action-card--positionable u-border--solid" data-ng-class="{ 'is-error': node.memory_test_status === 3 }">
            <div maas-card-loader="memory"></div>
          </div>
          <div class="col-4 p-card--highlighted action-card action-card--positionable u-border--solid" data-ng-class="{ 'is-error': node.storage_test_status === 3 }">
            <div maas-card-loader="storage"></div>
          </div>
        </div>
        <div class="row u-equal-height" data-ng-if="node.node_type == 2">
          <div class="col-4 p-card--highlighted action-card action-card--positionable u-border--solid">
            <div maas-card-loader="tags"></div>
          </div>
        </div>
        <div class="row u-equal-height" data-ng-if="node.node_type == 3">
          <div class="col-4 p-card--highlighted action-card u-border--solid">
            <div maas-card-loader="services"></div>
          </div>
          <div class="col-4 p-card--highlighted action-card action-card--positionable u-border--solid">
            <div maas-card-loader="controller"></div>
          </div>
          <div class="col-4 p-card--highlighted action-card action-card--positionable u-border--solid" data-ng-class="{ 'is-error': node.cpu_test_status === 3 }">
            <div maas-card-loader="cpu"></div>
          </div>
        </div>
        <div class="row u-equal-height" data-ng-if="node.node_type == 3">
          <div class="col-4 p-card--highlighted action-card action-card--positionable u-border--solid" data-ng-class="{ 'is-error': node.memory_test_status === 3 }">
            <div maas-card-loader="memory"></div>
          </div>
          <div class="col-4 p-card--highlighted action-card action-card--positionable u-border--solid" data-ng-class="{ 'is-error': node.storage_test_status === 3 }">
            <div maas-card-loader="storage"></div>
          </div>
          <div class="col-4 p-card--highlighted action-card action-card--positionable u-border--solid">
            <div maas-card-loader="tags"></div>
          </div>
        </div>
        <div class="row u-equal-height" data-ng-if="node.node_type == 4">
          <div class="col-4 p-card--highlighted action-card u-border--solid">
            <div maas-card-loader="services"></div>
          </div>
          <div class="col-8">
            <div class="row u-equal-height">
              <div class="col-4 p-card--highlighted action-card action-card--positionable u-border--solid">
                <div maas-card-loader="images"></div>
              </div>
              <div class="col-4 p-card--highlighted action-card action-card--positionable u-border--solid">
                <div maas-card-loader="controller"></div>
              </div>
            </div>
            <div class="row u-equal-height">
              <div class="col-4 p-card--highlighted action-card action-card--positionable u-border--solid" data-ng-class="{ 'is-error': node.cpu_test_status === 3 }">
                <div maas-card-loader="cpu"></div>
              </div>
              <div class="col-4 p-card--highlighted action-card action-card--positionable u-border--solid" data-ng-class="{ 'is-error': node.memory_test_status === 3 }">
                <div maas-card-loader="memory"></div>
              </div>
            </div>
          </div>
        </div>
        <div class="row u-equal-height" data-ng-if="node.node_type == 4">
          <div class="col-4 p-card--highlighted action-card u-border--solid" data-ng-class="{ 'is-error': node.storage_test_status === 3 }">
            <div maas-card-loader="storage"></div>
          </div>
          <div class="col-4 p-card--highlighted action-card action-card--positionable u-border--solid">
            <div maas-card-loader="tags"></div>
          </div>
        </div>
        <div class="row u-equal-height" data-ng-if="!isDevice && !isController">
            <div class="col-4 p-card--highlighted action-card action-card--positionable u-border--solid" data-ng-if="!isController" data-ng-class="{ 'is-error': node.cpu_test_status === 3 }">
              <div maas-card-loader="cpu"></div>
            </div>
            <div class="col-4 p-card--highlighted action-card action-card--positionable u-border--solid" data-ng-if="!isController" data-ng-class="{ 'is-error': node.memory_test_status === 3 }">
              <div maas-card-loader="memory"></div>
                </div>
            <div class="col-4 p-card--highlighted action-card action-card--positionable u-border--solid" data-ng-if="node.node_type != 3" data-ng-class="{ 'is-error': node.storage_test_status === 3 }">
              <div maas-card-loader="storage"></div>
            </div>
        </div>
        <div class="row u-equal-height" data-ng-if="!isDevice && !isController">
          <div class="col-4 p-card--highlighted action-card action-card--positionable u-border--solid" data-ng-if="!isController">
            <div maas-card-loader="machine"></div>
          </div>
          <div class="col-4 p-card--highlighted action-card action-card--positionable u-border--solid" data-ng-if="!isController">
            <div maas-card-loader="tags"></div>
          </div>
        </div>
      </div>
    </section>
    <section class="p-strip" data-ng-if="section.area === 'containers'">
        <div class="row">
            <table>
                <thead>
                    <tr>
                        <th class="col-4">Name</th>
                        <th class="col-4">MAC</th>
                        <th class="col-4">IP Address</th>
                    </tr>
                </thead>
                <tbody data-selected-rows>
                    <tr data-ng-repeat="device in devices">
                        <td class="col-4">{$ device.name $}</td>
                        <td class="col-4">{$ device.mac_address $}</td>
                        <td class="col-4">{$ device.ip_address $}</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </section>
    <section class="p-strip" data-ng-if="section.area === 'configuration'">
        <div class="row">
            <div class="col-10">
                <h2 data-ng-if="!isController">{$ node.node_type_display $} configuration</h2>
                <h2 data-ng-if="isController">Controller configuration</h2>
            </div>
            <div class="col-2 u-align--right">
                <button class="p-button--neutral"
                    data-ng-if="canEdit()"
                    data-ng-click="editSummary()">Edit</button>
            </div>
        </div>
        <form class="p-form p-form--stacked">
            <div class="row">
                <div class="col-6">
                    <div class="p-form__group" data-ng-if="!isDevice && !isController"
                        data-ng-class="{ 'is-error': invalidArchitecture() }">
                        <label for="architecture" class="p-form__label">Architecture</label>
                        <div class="p-form__control">
                            <select name="architecture" id="architecture" class="p-form-validation__input"
                                data-ng-disabled="!summary.editing"
                                data-ng-model="summary.architecture.selected"
                                data-ng-options="arch for arch in summary.architecture.options">
                                <option value="" disabled="disabled">{$ getArchitecturePlaceholder() $}</option>
                            </select>
                        </div>
                    </div>
                    <div class="p-form__group" data-ng-if="!isDevice && !isController">
                        <label for="min_hwe_kernel" class="p-form__label">Minimum Kernel</label>
                        <div class="p-form__control">
                            <select name="min_hwe_kernel" id="min_hwe_kernel"
                                data-ng-disabled="!summary.editing"
                                data-ng-model="summary.min_hwe_kernel.selected"
                                data-ng-options="hwe_kernel[0] as hwe_kernel[1] for hwe_kernel in summary.min_hwe_kernel.options">
                                <option value="">No minimum kernel</option>
                            </select>
                        </div>
                    </div>
                    <div class="p-form__group">
                        <label for="zone" class="p-form__label">Zone</label>
                        <div class="p-form__control">
                            <select name="zone" id="zone"
                                data-ng-disabled="!summary.editing"
                                data-ng-model="summary.zone.selected"
                                data-ng-options="zone as zone.name for zone in summary.zone.options">
                                <option value="" disabled="disabled">Choose a zone</option>
                            </select>
                        </div>
                    </div>
                    <div class="p-form__group">
                        <label class="p-form__label">Tags</label>
                        <div class="p-form__control tags--inline">
                            <span data-ng-repeat="tag in node.tags" data-ng-hide="summary.editing">
                                <a href="#/nodes/?query=tags:({$ tag $})">{$ tag $}</a>
                            </span>
                            <tags-input data-ng-model="summary.tags"
                                data-ng-show="summary.editing" allowed-tags-pattern="[\w-]+">
                                <auto-complete source="tagsAutocomplete($query)"></auto-complete>
                            </tags-input>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-12 u-align--right" data-ng-if="summary.editing">
                    <button class="p-button--base"
                       data-ng-click="cancelEditSummary()">Cancel</button>
                    <button class="p-button--positive"
                        data-ng-class="{ secondary: invalidArchitecture() }"
                        data-ng-click="saveEditSummary()">Save changes</button>
                </div>
            </div>
        </form>
        <div class="row">
            <div class="col-10" data-ng-if="!isDevice">
                <h2>Power configuration</h2>
            </div>
            <div class="col-2 u-align--right">
                <button class="p-button--neutral"
                    data-ng-show="canEdit() && power_types.length"
                    data-ng-click="editPower()"
                    data-ng-if="!power.editing">Edit</button>
            </div>
        </div>
        <div class="row">
            <div class="col-12" data-ng-if="!isDevice">
                <div class="p-notification--negative" data-ng-if="!isRackControllerConnected()">
                    <p class="p-notification__response">
                      <span class="p-notification__status">Error:</span> Editing is currently
                      disabled because no rack controller is current
                      connected to the region.</p>
                </div>
                <div class="p-notification--negative"
                     data-ng-if="isRackControllerConnected() && node.power_type == '' && !isController">
                    <p class="p-notification__response">
                      <span class="p-notification__status">Error:</span> This node does not
                      have a power type set and MAAS will be unable to
                      control it. Update the power information below.</p>
                </div>
                <div class="p-notification--warning"
                     data-ng-if="isRackControllerConnected() && node.power_type == '' && isController">
                    <p class="p-notification__response">
                      <span class="p-notification__status">Warning:</span> This node does not
                      have a power type set and MAAS will be unable to
                      control it. Update the power information below.</p>
                </div>
                <div class="p-notification--negative" data-ng-if="hasPowerError()">
                    <p class="p-notification__response">
                      <span class="p-notification__status">Error:</span> Power control
                      software for this power type is missing from the rack
                      controller.  To proceed, install the
                      {$ getPowerErrors() $} on the rack controller.</p>
                </div>
                <div class="p-notification--negative" data-ng-if="hasPowerEventError()">
                    <p class="p-notification__response">
                      <span class="p-notification__status">Error:</span> {$ getPowerEventErrorText() $}</p>
                </div>
                <div class="p-notification" data-ng-if="power.type.name == 'manual'">
                    <p class="p-notification__response">Power control for
                      this power type will need to be handled manually.</p>
                </div>
                <div class="p-notification" data-ng-if="power.editing && node.power_bmc_node_count > 1">
                    <p class="p-notification__response">This power controller
                      manages {$ node.power_bmc_node_count - 1 $} other
                    {$ node.power_bmc_node_count > 3 ? "nodes" : "node" $}.
                    Changing power parameters will affect these nodes.</p>
                </div>
            </div>
        </div>
        <form class="p-form p-form--stacked" class="disabled" data-ng-if="!isDevice">
            <div class="row">
                <div class="col-6 ng-hide"
                    data-ng-show="power_types.length"
                    data-ng-disabled="!power.editing"
                    data-maas-power-parameters="power_types"
                    data-ng-model="power">
                </div>
            </div>
            <div class="row">
                <div class="col-12 u-align--right ng-hide" data-ng-show="power.editing">
                    <button class="p-button--base" type="button"
                        data-ng-click="cancelEditPower()">Cancel</button>
                    <button class="p-button--positive"
                        data-ng-class="{ secondary: invalidPowerType() }"
                        data-ng-click="saveEditPower()">Save changes</button>
                </div>
            </div>
        </form>
    </section>
    <section class="p-strip" data-ng-if="section.area === 'services'">
        <div class="row" data-ng-show="node.node_type == 3 || node.node_type == 4">
            <div class="col-12">
                <h3>Region Controller</h3>
                <ul class="p-list-tree" aria-multiselectable="true" role="tablist">
                    <li class="p-list-tree__item">
                        <span>
                            <span class="p-icon--{$ getServiceClass(services.regiond) $}"></span>
                            &nbsp;regiond
                            <span data-ng-if="services.regiond.status_info"> &mdash; {$ services.regiond.status_info $}</span>
                        </span>
                    </li>
                    <li class="p-list-tree__item">
                        <span>
                            <span class="p-icon--{$ getServiceClass(services.bind9) $}"></span>
                            &nbsp;bind9
                            <span data-ng-if="services.bind9.status_info"> &mdash; {$ services.bind9.status_info $}</span>
                        </span>
                    </li>
                    <li class="p-list-tree__item">
                        <span>
                            <span class="p-icon--{$ getServiceClass(services.proxy) $}"></span>
                            &nbsp;proxy
                            <span data-ng-if="services.proxy.status_info"> &mdash; {$ services.proxy.status_info $}</span>
                        </span>
                    </li>
                    <li class="p-list-tree__item" data-ng-if="services.ntp_region">
                        <span>
                            <span class="p-icon--{$ getServiceClass(services.ntp_region) $}"></span>
                            &nbsp;ntp
                            <span data-ng-if="services.ntp_region.status_info"> &mdash; {$ services.ntp_region.status_info $}</span>
                        </span>
                    </li>
                </ul>
            </div>
        </div>
        <div class="row" data-ng-show="node.node_type == 2 || node.node_type == 4">
            <div class="col-12">
                <h3>Rack Controller</h3>
                <ul class="p-list-tree" aria-multiselectable="true" role="tablist">
                    <li class="p-list-tree__item p-list-tree__item--group">
                        <span>
                            <span class="p-icon--{$ getServiceClass(services.rackd) $}"></span>
                            &nbsp;rackd
                            <span data-ng-if="services.rackd.status_info"> &mdash; {$ services.rackd.status_info $}</span>
                        </span>
                        <ul class="p-list-tree" role="tabpanel" aria-hidden="true">
                            <li class="p-list-tree__item">
                                <span>
                                    <span class="p-icon--{$ getServiceClass(services.http) $}"></span>
                                    &nbsp;http
                                    <span data-ng-if="services.http.status_info"> &mdash; {$ services.http.status_info $}</span>
                                </span>
                            </li>
                            <li class="p-list-tree__item">
                                <span>
                                    <span class="p-icon--{$ getServiceClass(services.tftp) $}"></span>
                                    &nbsp;tftp
                                    <span data-ng-if="services.tftp.status_info"> &mdash; {$ services.tftp.status_info $}</span>
                                </span>
                            </li>
                        </ul>
                    </li>
                    <li class="p-list-tree__item">
                        <span>
                            <span class="p-icon--{$ getServiceClass(services.dhcpd) $}"></span>
                            &nbsp;dhcpd
                            <span data-ng-if="services.dhcpd.status_info"> &mdash; {$ services.dhcpd.status_info $}</span>
                        </span>
                    </li>
                    <li class="p-list-tree__item">
                        <span>
                            <span class="p-icon--{$ getServiceClass(services.dhcpd6) $}"></span>
                            &nbsp;dhcpd6
                            <span data-ng-if="services.dhcpd6.status_info"> &mdash; {$ services.dhcpd6.status_info $}</span>
                        </span>
                    </li>
                    <li class="p-list-tree__item">
                        <span>
                            <span class="p-icon--{$ getServiceClass(services.tgt) $}"></span>
                            &nbsp;tgt
                            <span data-ng-if="services.tgt.status_info"> &mdash; {$ services.tgt.status_info $}</span>
                        </span>
                    </li>
                    <li class="p-list-tree__item" data-ng-if="services.ntp_rack">
                        <span>
                            <span class="p-icon--{$ getServiceClass(services.ntp_rack) $}"></span>
                            &nbsp;ntp
                            <span data-ng-if="services.ntp_rack.status_info"> &mdash; {$ services.ntp_rack.status_info $}</span>
                        </span>
                    </li>
                </ul>
            </div>
        </div>
    </section>
    <section class="u-no-margin--top" data-ng-if="section.area === 'vlans' || section.area === 'interfaces'" data-ng-controller="NodeNetworkingController">
        <div class="p-strip" data-ng-if="section.area === 'vlans'">
            <div class="row" data-ng-if="!loaded">
                <div class="col-12">
                    <p class="u-text--loading"><i class="p-icon--spinner u-animation--spin"></i>&nbsp;&nbsp;Loading...</p>
                </div>
            </div>
            <div class="row">
                <form data-ng-if="loaded">
                    <table>
                        <thead>
                            <tr>
                                <th class="col-2">Fabric</th>
                                <th class="col-2">VLAN</th>
                                <th class="col-1">DHCP</th>
                                <th class="col-3">Subnets</th>
                                <th class="col-2">Primary rack</th>
                                <th class="col-2">Secondary rack</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="table__row" data-ng-repeat="vlanRow in vlanTable">
                                <td class="col-2">
                                    <a href="#/fabric/{$ vlanRow['fabric'].id $}">{$ vlanRow['fabric'].name $}</a>
                                </td>
                                <td class="col-2">
                                    <a href="#/vlan/{$ vlanRow['vlan'].id $}">{$ getVLANText(vlanRow['vlan']) $}</a>
                                </td>
                                <td class="col-1">
                                    <p data-ng-if="vlanRow.vlan.dhcp_on === true || vlanRow.vlan.relay_vlan !== null || vlanRow.vlan.external_dhcp === true">Enabled</p>
                                    <p data-ng-if="vlanRow.vlan.dhcp_on !== true && vlanRow.vlan.relay_vlan === null">Disabled</p>
                                </td>
                                <td class="col-3">
                                    <div class="u-no-margin--top" data-ng-repeat="subnet in vlanRow['subnets']">
                                      <a href="#/subnet/{$ subnet.id $}">{$ getSubnetText(subnet) $}</a>
                                    </div>
                                </td>
                                <td class="col-2">
                                    <a href="#/node/controller/{$ vlanRow['primary_rack'].system_id $}">{$ vlanRow['primary_rack'].fqdn $}</a>
                                </td>
                                <td class="col-2">
                                    <a href="#/node/controller/{$ vlanRow['secondary_rack'].system_id $}">{$ vlanRow['secondary_rack'].fqdn $}</a>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </form>
            </div>
        </div>
        <div class="p-strip" data-ng-if="section.area === 'interfaces'">
            <div class="row" data-ng-if="!loaded">
                <div class="col-12">
                    <p><i class="p-icon--spinner u-animation--spin"></i> Loading...</p>
                </div>
            </div>
            <form data-ng-if="loaded">
                <div class="row" data-ng-if="
                !isDevice && ((!isController && isAllNetworkingDisabled() && isSuperUser()) ||
                !node.on_network || (!isController && !isUbuntuOS()))">
                    <div class="col-12">
                        <div class="p-notification--negative" data-ng-if="!node.on_network">
                            <p class="p-notification__response">
                                <span class="p-notification__status">Error:</span> Node must be connected to a network.</p>
                        </div>
                        <div class="p-notification" data-ng-if="!isController && isAllNetworkingDisabled() && isSuperUser()">
                            <p class="p-notification__response">Interface
                                configuration cannot be modified unless the
                                node is Ready, Allocated, or Broken.</p>
                        </div>
                        <div class="p-notification--warning" data-ng-if="!isController && isCustomOS()">
                            <p class="p-notification__response">
                                <span class="p-notification__status">Important:</span> Custom images may require special preparation to support custom network configuration.
                            </p>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <table class="p-table-expanding">
                        <thead>
                            <tr>
                                <th class="col-2">
                                    <span data-ng-if="!isDevice">
                                        <a data-ng-class="{ 'p-link--strong': tableInfo.column == 'name' }"
                                            data-ng-click="tableInfo.column = 'name'">
                                            Name
                                        </a>
                                        <span> | </span>
                                        <a data-ng-class="{ 'p-link--strong': tableInfo.column == 'mac' }"
                                            data-ng-click="tableInfo.column = 'mac'">
                                            MAC
                                        </a>
                                    </span>
                                    <span data-ng-if="isDevice">MAC</span>
                                </th>
                                <th class="col-1 u-align--center"><span data-ng-if="!isController && !isDevice">PXE</span></th>
                                <th class="col-1"><span data-ng-if="!isDevice">Type</span></th>
                                <th class="col-1">
                                    <span data-ng-if="!isDevice">Fabric</span>
                                    <span data-ng-if="isDevice">IP Assignment</span>
                                </th>
                                <th class="col-1"><span data-ng-if="!isDevice">VLAN</span></th>
                                <th class="col-3">Subnet</th>
                                <th class="col-2">IP Address</th>
                                <th class="col-1 u-align--center">Actions</th>
                            </tr>
                        </thead>
                        <tbody data-selected-rows>
                            <tr data-ng-class="{ disabled: isDisabled(), 'is-active': isInterfaceSelected(interface) && (!isAllNetworkingDisabled() || isLimitedEditingAllowed(interface)), noEdit: cannotEditInterface(interface) }"
                                data-ng-repeat="interface in interfaces | removeInterfaceParents:newBondInterface:isAllNetworkingDisabled() | removeInterfaceParents:newBridgeInterface:isAllNetworkingDisabled()">
                                <td class="col-2" aria-label="Name" data-ng-if="!isDevice"
                                    data-ng-class="{ 'is-error': isInterfaceNameInvalid(editInterface) }">
                                    <ul class="p-inline-list u-no-margin--top">
                                        <li class="p-inline-list__item" data-ng-if="!isController && !isAllNetworkingDisabled() && !isEditing(interface)">
                                            <input type="checkbox" class="checkbox" id="{$ getUniqueKey(interface) $}"
                                            data-ng-hide="isAllNetworkingDisabled()"
                                            data-ng-checked="isInterfaceSelected(interface)"
                                            data-ng-click="toggleInterfaceSelect(interface)"
                                            data-ng-disabled="isDisabled()">
                                        </li>
                                        <li class="p-inline-list__item">
                                            <span data-ng-if="!isEditing(interface)" data-ng-show="tableInfo.column == 'name'">{$ interface.name $}</span>
                                            <span class="ng-hide" data-ng-show="tableInfo.column == 'mac'">{$ interface.mac_address $}</span>
                                            <input type="text" class="p-form-validation__input u-no-margin--top"
                                                data-ng-if="isEditing(interface) && interface.type !== 'vlan'"
                                                data-ng-model="editInterface.name">
                                        </li>
                                    </ul>
                                </td>
                                <td class="col-1" data-ng-if="isDevice">{$ interface.mac_address $}</td>
                                <td class="col-1 u-align--center" aria-label="Boot interface">
                                    <span class="u-hide u-show--large">
                                        <input type="radio" name="bootInterface" id="{$ interface.name $}" checked
                                            data-ng-if="!isController && !isDevice && isBootInterface(interface)"
                                            class="u-no-margin--right">
                                        <label for="{$ interface.name $}"></label>
                                    </span>
                                    <span class="u-hide--large" data-ng-if="!isController && !isDevice && isBootInterface(interface)">Yes</span>
                                    <span class="u-hide--large" data-ng-if="!isController && !isDevice && !isBootInterface(interface)">No</span>
                                </td>
                                <td class="col-1" aria-label="Type">
                                    <span data-ng-if="!isDevice && !isEditing(interface)">{$ getInterfaceTypeText(interface) $}</span>
                                </td>
                                <td class="col-1" aria-label="Fabric">
                                    <span data-ng-if="!isDevice && !isEditing(interface)">{$ interface.fabric.name || "Disconnected" $}</span>
                                    <span data-ng-if="isDevice && !isEditing(interface)">{$ getDeviceIPAssignment(interface.ip_assignment) $}</span>
                                </td>
                                <td class="col-1" aria-label="VLAN">
                                    <span data-ng-if="!isDevice && !isEditing(interface)">{$ getVLANText(interface.vlan) $}</span>
                                </td>
                                <td class="col-3" aria-label="Subnet">
                                    <span data-ng-if="!isEditing(interface) && ((isDevice && interface.subnet) || (interface.fabric && !interface.discovered[0].subnet_id))">{$ getSubnetText(interface.subnet) $}</span>
                                    <span data-ng-if="isAllNetworkingDisabled() && interface.discovered[0].subnet_id">
                                        {$ getSubnetText(getSubnet(interface.discovered[0].subnet_id)) $}
                                    </span>
                                </td>
                                <td class="col-2" aria-label="IP Address">
                                    <span data-ng-if="isDevice">
                                        {$ interface.ip_address $}
                                    </span>
                                    <span data-ng-if="!isDevice && !isEditing(interface) && !interface.discovered[0].ip_address && interface.fabric" >
                                        {$ interface.ip_address $} ({$ getLinkModeText(interface) $})
                                    </span>
                                    <span data-ng-if="!isDevice && !isEditing(interface) && interface.discovered[0].ip_address && interface.fabric">
                                        {$ interface.discovered[0].ip_address $} (DHCP)
                                    </span>
                                </td>
                                <td class="col-1">
                                    <div class="p-contextual-menu" toggle-ctrl  data-ng-if="!isAllNetworkingDisabled() || isLimitedEditingAllowed(interface)">
                                        <button class="p-contextual-menu__toggle p-button--base" data-ng-click="toggleMenu()"><i class="p-icon--contextual-menu u-no-margin--right">Actions</i></button>
                                        <div class="p-contextual-menu__dropdown" role="menu" data-ng-show="isToggled">
                                            <button class="p-contextual-menu__link"
                                                aria-label="Add Alias or VLAN"
                                                data-ng-if="!isDevice && canAddAliasOrVLAN(interface)"
                                                data-ng-click="toggleMenu(); quickAdd(interface)">Add alias or VLAN</button>
                                            <button class="p-contextual-menu__link"
                                                data-ng-if="!cannotEditInterface(interface)"
                                                aria-label="Edit"
                                                data-ng-click="toggleMenu(); edit(interface)">Edit {$ getInterfaceTypeText(interface) $}</button>
                                            <button class="p-contextual-menu__link"
                                                data-ng-if="canBeRemoved()"
                                                aria-label="Remove"
                                                data-ng-click="toggleMenu(); quickRemove(interface)">Remove {$ getInterfaceTypeText(interface) $}&hellip;</button>
                                        </div>
                                    </div>
                                </td>
                                <td class="p-table-expanding__panel col-12" data-ng-if="isShowingMembers(interface)">
                                    <div class="row" data-ng-class="{ 'is-active': isShowingMembers(interface) }"
                                        data-ng-repeat="member in interface.members"
                                        data-ng-show="isShowingMembers(interface)">
                                        <div class="col-1"></div>
                                        <div class="col-2" data-ng-show="tableInfo.column == 'name'">{$ member.name $}</div>
                                        <div class="col-2 ng-hide"data-ng-show="tableInfo.column == 'mac'">{$ member.mac_address $}</div>
                                        <div class="col-2">{$ getInterfaceTypeText(member) $}</div>
                                        <div class="col-7"></div>
                                    </div>
                                </td>

                                <td class="p-table-expanding__panel col-12 u-no-padding"  data-ng-if="isInterfaceSelected(interface)">
                                    <div class="row" data-ng-if="isShowingAdd() || isEditing(interface) || isShowingDeleteConfirm() || isShowingAdd() && !newInterface.saving">
                                        <div class="table__dropdown-title" data-ng-if="windowWidth <= 768">
                                            <h2 data-ng-click="cancel()" class="u-float--left">
                                                <span data-ng-if="canAddAlias(newInterface.parent)">Adding alias</span>
                                                <span data-ng-if="canAddVLAN(newInterface.parent)">Adding VLAN</span>
                                                <span data-ng-if="isEditing(interface)">Editing {$ interface.name $}</span>
                                                <span data-ng-if="isShowingDeleteConfirm()">Removing {$ interface.name $}</span>
                                            </h2>
                                            <button data-ng-click="cancel()" class="p-button u-float--right">
                                                <i class="p-icon--remove">Cancel</i>
                                            </button>
                                        </div>
                                        <div class="p-form p-form--stacked" data-ng-class="{ 'is-active': isEditing(interface) || isShowingAdd() }">
                                            <div class="row" data-ng-if="isShowingAdd()">
                                                <div class="col-6">
                                                    <div class="p-form__group">
                                                        <label class="p-form__label">Name</label>
                                                        <div class="p-form__control">
                                                            <span class="col-4">{$ getAddName() $}</span>
                                                        </div>
                                                    </div>
                                                    <div class="p-form__group">
                                                        <label for="type" class="p-form__label">Type</label>
                                                        <div class="p-form__control">
                                                            <select name="type" data-ng-model="newInterface.type" data-ng-change="addTypeChanged()">
                                                                <option value="alias" data-ng-show="canAddAlias(newInterface.parent)">Alias</option>
                                                                <option value="vlan" data-ng-show="canAddVLAN(newInterface.parent)">VLAN</option>
                                                            </select>
                                                        </div>
                                                    </div>
                                                    <div class="p-form__group" data-ng-if="newInterface.type !== 'alias'">
                                                        <label class="p-form__label">Tags</label>
                                                        <div class="p-form__control tags--inline">
                                                            <tags-input data-ng-model="newInterface.tags" allow-tags-pattern="[\w-]+"></tags-input>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-6">
                                                    <div class="p-form__group">
                                                        <label for="fabric" class="p-form__label">Fabric</label>
                                                        <div class="p-form__control">
                                                            <select name="fabric"
                                                                data-ng-model="newInterface.parent.fabric"
                                                                data-ng-options="fabric as fabric.name for fabric in fabrics"
                                                                disabled="disabled">
                                                            </select>
                                                        </div>
                                                    </div>
                                                    <div class="p-form__group" data-ng-if="newInterface.type === 'alias'">
                                                        <label for="vlan" class="p-form__label">VLAN</label>
                                                        <div class="p-form__control">
                                                            <select name="vlan"
                                                                data-ng-model="newInterface.vlan"
                                                                data-ng-options="vlan as getVLANText(vlan) for vlan in vlans"
                                                                disabled="disabled">
                                                            </select>
                                                        </div>
                                                    </div>
                                                    <div class="p-form__group" data-ng-if="newInterface.type === 'vlan'">
                                                        <label for="vlan" class="p-form__label">VLAN</label>
                                                        <div class="p-form__control">
                                                            <select name="vlan"
                                                                data-ng-model="newInterface.vlan"
                                                                data-ng-change="vlanChanged(newInterface)"
                                                                data-ng-options="vlan as getVLANText(vlan) for vlan in vlans | removeDefaultVLAN | filterByFabric:newInterface.parent.fabric | filterByUnusedForInterface:newInterface.parent:originalInterfaces">
                                                            </select>
                                                        </div>
                                                    </div>
                                                    <div class="p-form__group">
                                                        <label for="subnet" class="p-form__label">Subnet</label>
                                                        <div class="p-form__control">
                                                            <select name="subnet"
                                                                data-ng-model="newInterface.subnet"
                                                                data-ng-change="subnetChanged(newInterface)"
                                                                data-ng-options="subnet as getSubnetText(subnet) for subnet in subnets | filterByVLAN:newInterface.vlan">
                                                                <option value="" data-ng-hide="newInterface.type === 'alias'">Unconfigured</option>
                                                            </select>
                                                        </div>
                                                    </div>
                                                    <div class="p-form__group" data-ng-if="!isLinkModeDisabled(newInterface)">
                                                        <label for="link-mode" class="p-form__label">IP mode</label>
                                                        <div class="p-form__control">
                                                            <select name="link-mode"
                                                                data-ng-model="newInterface.mode"
                                                                data-ng-change="modeChanged(newInterface)"
                                                                data-ng-options="mode.mode as mode.text for mode in modes | filterLinkModes:newInterface">
                                                            </select>
                                                        </div>
                                                    </div>
                                                    <div class="p-form__group" data-ng-if="newInterface.mode == 'static'">
                                                        <label for="ip-address" class="p-form__label">IP address</label>
                                                        <div class="p-form__control">
                                                            <input name="ip-address" type="text"
                                                                placeholder="IP address"
                                                                data-ng-model="newInterface.ip_address"
                                                                data-ng-class="{ 'is-error': isIPAddressInvalid(newInterface) }">
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <maas-obj-form obj="editInterface" manager="nodesManager" manager-method="updateInterfaceForm"
                                                table-form="true" save-on-blur="false" after-save="editSave" pre-process="preProcessInterface"
                                                data-ng-if="isEditing(editInterface)">
                                                <div class="row">
                                                    <div class="col-6">
                                                        <div class="p-form__group" data-ng-if="!isDevice">
                                                            <label class="p-form__label">Type</label>
                                                            <div class="p-form__control">
                                                                <span>{$ getInterfaceTypeText(interface) $}</span>
                                                            </div>
                                                        </div>
                                                        <maas-obj-field type="text" key="mac_address" label="MAC address" label-width="2" input-width="5"
                                                            data-ng-if="interface.type !== 'alias' && interface.type !== 'vlan'" disable-label="false"
                                                            input-class="table__input u-margin--none" placeholder="00:00:00:00:00:00"></maas-obj-field>
                                                        <maas-obj-field type="tags" key="tags" label="Tags" label-width="2" input-width="5"
                                                            placeholder="Add a tag"
                                                            data-ng-if="!isAllNetworkingDisabled(interface) && interface.type !== 'alias'"
                                                            disable-label="false"></maas-obj-field>
                                                    </div>
                                                    <div class="col-6" data-ng-if="!isAllNetworkingDisabled(interface)">
                                                        <maas-obj-field type="options" key="fabric" label="Fabric" label-width="2" input-width="5"
                                                            disable-label="false"
                                                            data-ng-if="!isDevice"
                                                            placeholder="Disconnected" placeholder-enabled="true"
                                                            on-change="fabricChangedForm"
                                                            options="fabric as fabric.name for fabric in fabrics"></maas-obj-field>
                                                        <maas-obj-field type="options" key="vlan" label="VLAN" label-width="2" input-width="5"
                                                            disable-label="false"
                                                            data-ng-if="!isDevice && editInterface.$maasForm.getValue('fabric')"
                                                            disabled="interface.type === 'physical' || interface.type === 'bond'"
                                                            on-change="vlanChangedForm"
                                                            options="vlan as getVLANText(vlan) for vlan in vlans | removeDefaultVLANIfVLAN:interface.type | filterByFabric:editInterface.$maasForm.getValue('fabric')">
                                                        </maas-obj-field>
                                                        <maas-obj-field type="options" key="ip_assignment" label="IP Assignment" label-width="2" input-width="5"
                                                            disable-label="false"
                                                            data-ng-if="isDevice"
                                                            options="assignment.name as assignment.text for assignment in ipAssignments"></maas-obj-field>
                                                        <maas-obj-field type="options" key="subnet" label="Subnet" placeholder="Unconfigured" placeholder-enabled="true"
                                                            disable-label="false" label-width="2" input-width="5"
                                                            data-ng-if="!isDevice && editInterface.$maasForm.getValue('fabric')"
                                                            on-change="subnetChangedForm"
                                                            options="subnet as getSubnetText(subnet) for subnet in subnets | filterByVLAN:editInterface.$maasForm.getValue('vlan')">
                                                            </maas-obj-field>
                                                        <maas-obj-field type="options" key="subnet" label="Subnet" placeholder="Unconfigured" placeholder-enabled="true"
                                                            data-ng-init="editInterface.subnet = editInterface.defaultSubnet" label-width="2" input-width="5"
                                                            data-ng-if="isDevice && editInterface.$maasForm.getValue('ip_assignment') === 'static'"
                                                            on-change="subnetChangedForm"
                                                            disable-label="false"
                                                            options="subnet as getSubnetText(subnet) for subnet in subnets"></maas-obj-field>
                                                        <maas-obj-field type="options" key="mode" label="IP mode" label-width="2" input-width="5"
                                                            disable-label="false"
                                                            data-ng-if="!isDevice && editInterface.$maasForm.getValue('fabric') && !isLinkModeDisabled(editInterface.$maasForm)"
                                                            options="mode.mode as mode.text for mode in modes | filterLinkModes:editInterface.$maasForm">
                                                            on-change="modeChangedForm"
                                                            </maas-obj-field>
                                                        <maas-obj-field type="text" key="ip_address" label="IP address" placeholder="IP Address" label-width="two" input-width="three"
                                                            disable-label="false" input-class="table__input u-margin--none"
                                                            data-ng-if="(!isDevice && editInterface.$maasForm.getValue('fabric') && editInterface.$maasForm.getValue('mode') == 'static') || (isDevice && editInterface.$maasForm.getValue('ip_assignment') === 'external')">
                                                            </maas-obj-field>
                                                        <maas-obj-field type="text" key="ip_address" label="IP Address" placeholder="IP Address (optional)"
                                                            data-ng-if="isDevice && editInterface.$maasForm.getValue('ip_assignment') === 'static'" label-width="2" input-width="5"
                                                            disable-label="false"></maas-obj-field>
                                                    </div>
                                                </div>
                                                <div class="row u-no-margin--top">
                                                    <hr />
                                                    <div class="u-float--left">
                                                        <maas-obj-errors></maas-obj-errors>
                                                    </div>
                                                    <div class="u-float--right u-no-margin--top">
                                                        <button class="p-button--base"
                                                            data-ng-click="editCancel()">Cancel</button>
                                                        <button class="p-button--positive u-no-margin--top"
                                                        data-ng-disabled="(!isDevice && isInterfaceNameInvalid(editInterface)) || isIPAddressInvalid(editInterface) || isMACAddressInvalid(editInterface.mac_address, true)"
                                                        maas-obj-save>Save</button>
                                                    </div>
                                                </div>
                                            </maas-obj-form>
                                        </div>
                                        <div class="row is-active" data-ng-if="isShowingDeleteConfirm() && isInterfaceSelected(interface)">
                                            <div class="col-8">
                                                <p><span class="p-icon--warning">Warning:</span> Are you sure you want to remove this {$ getRemoveTypeText(interface) $}?</p>
                                            </div>
                                            <div class="col-4 u-align--right">
                                                <button class="p-button--base" data-ng-click="cancel()">Cancel</button>
                                                <button class="p-button--negative u-no-margin--top" data-ng-click="confirmRemove(interface)">Remove</button>
                                            </div>
                                        </div>
                                        <hr data-ng-if="isShowingAdd() && !newInterface.saving" />
                                        <div class="row" data-ng-if="isShowingAdd() && !newInterface.saving">
                                            <div class="col-6">
                                                <button class="p-button--neutral"
                                                    data-ng-click="addInterface('alias')"
                                                    data-ng-show="canAddAlias(interface)">Add <span data-ng-show="newInterface.type === 'alias'">another </span>alias</button>
                                                <button class="p-button--neutral u-no-margin--top"
                                                    data-ng-click="addInterface('vlan')"
                                                    data-ng-show="canAddAnotherVLAN(interface)">Add <span data-ng-show="newInterface.type === 'vlan'">another </span>VLAN</button>
                                            </div>
                                            <div class="col-6 u-align--right">
                                                <button class="p-button--base" data-ng-click="cancel()">Cancel</button>
                                                <button class="p-button--positive u-no-margin--top" data-ng-click="addInterface()">Add</button>
                                            </div>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            <tr class="row is-active" data-ng-if="isShowingCreateBond() && !isAllNetworkingDisabled()">
                                <td class="col-1">
                                    <input type="checkbox" class="checkbox" name="bond-create" disabled="disabled" checked />
                                    <label for="bond-create"></label>
                                </td>
                                <td class="col-2 p-form-validation" data-ng-class="{ 'is-error': isInterfaceNameInvalid(newBondInterface) }">
                                    <input type="text" name="name" class="editible p-form-validation__input"
                                        data-ng-model="newBondInterface.name">
                                </td>
                                <td class="col-1 u-align--center">
                                    <input type="radio" name="bondBootInterface" checked id="{$ newBondInterface $}"
                                        data-ng-if="hasBootInterface(newBondInterface)">
                                    <label for="{$ newBondInterface $}"></label>
                                </td>
                                <td class="col-8"></td>
                                <td class="p-table-expanding__panel col-12">
                                    <div class="row" data-ng-if="windowWidth <= 768">
                                        <div class="col-8">
                                            <h2 data-ng-click="cancel()" class="col-8">&lsaquo;&nbsp;&nbsp;
                                            Create bond
                                            </h2>
                                        </div>
                                        <div class="col-4">
                                            <button data-ng-click="cancel()" class="p-button">
                                                <i class="p-icon--close">Cancel</i>
                                            </button>
                                        </div>
                                    </div>
                                    <div class="p-form p-form--stacked is-active">
                                        <div class="row">
                                            <div class="col-6">
                                                <div class="p-form__group u-hide--large">
                                                    <label for="bond-name" class="p-form__label">Name</label>
                                                    <div class="p-form__control p-form-validation"
                                                        data-ng-class="{ 'is-error': isInterfaceNameInvalid(newBondInterface) }">
                                                        <input type="text" name="name" id="bond-name" class="p-form-validation__input"
                                                            data-ng-model="newBondInterface.name">
                                                    </div>
                                                </div>
                                                <div class="p-form__group">
                                                    <label for="bond-mode" class="p-form__label">Bond mode</label>
                                                    <div class="p-form__control">
                                                        <select name="bond-mode"
                                                            data-ng-model="newBondInterface.mode"
                                                            data-ng-options="mode[0] as mode[1] for mode in bondOptions.modes">
                                                        </select>
                                                    </div>
                                                </div>
                                                <div class="p-form__group">
                                                    <label for="mac" class="p-form__label">MAC address</label>
                                                    <div class="p-form__control p-form-validation"
                                                        data-ng-class="{ 'is-error': isMACAddressInvalid(newBondInterface.mac_address) }">
                                                        <input type="text" name="mac" class="p-form-validation__input"
                                                            placeholder="00:00:00:00:00:00"
                                                            data-ng-model="newBondInterface.mac_address"
                                                            data-ng-pattern="/^([0-9A-F]{2}[::]){5}([0-9A-F]{2})$/gmi" mac-address maxlength="17"
                                                            data-ng-placeholder="getInterfacePlaceholderMACAddress(newBondInterface)">
                                                    </div>
                                                </div>
                                                <div class="p-form__group">
                                                    <label class="p-form__label">Tags</label>
                                                    <div class="p-form__control tags--inline">
                                                        <tags-input data-ng-model="newBondInterface.tags" allow-tags-pattern="[\w-]+"></tags-input>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-6">
                                                <div class="p-form__group" data-ng-if="showLACPRate()">
                                                    <label for="lacp-rate" class="p-form__label">LACP rate</label>
                                                    <div class="p-form__control">
                                                        <select name="lacp-rate"
                                                            data-ng-model="newBondInterface.lacpRate"
                                                            data-ng-options="rate[0] as rate[1] for rate in bondOptions.lacp_rates">
                                                        </select>
                                                    </div>
                                                </div>
                                                <div class="p-form__group" data-ng-if="showXMITHashPolicy()">
                                                    <label for="xmit-hash-policy" class="p-form__label">XMIT hash policy</label>
                                                    <div class="p-form__control">
                                                        <select name="xmit-hash-policy"
                                                            data-ng-model="newBondInterface.xmitHashPolicy"
                                                            data-ng-options="xmit[0] as xmit[1] for xmit in bondOptions.xmit_hash_policies">
                                                        </select>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <table class="row">
                                        <tr class="u-hide u-show--large">
                                            <th class="col-3">Name</th>
                                            <th class="col-3">Type</th>
                                            <th class="col-6">Primary</th>
                                        </tr>
                                        <tr data-ng-repeat="parent in newBondInterface.parents | orderBy:'name'">
                                            <td class="col-3" aria-label="Name">{$ parent.name $}</td>
                                            <td class="col-3" aria-label="Type">{$ getInterfaceTypeText(parent) $}</td>
                                            <td class="col-6" aria-label="Primary">
                                                <input type="radio" name="bondPrimary" id="{$ parent.name $}" data-ng-model="newBondInterface.primary" data-ng-value="parent">
                                                <label for="{$ parent.name $}"></label>
                                            </td>
                                        </tr>
                                    </table>
                                    <div class="row">
                                        <hr />
                                        <div class="col-12 u-align--right">
                                            <button class="p-button--base" type="button" data-ng-click="cancel()">Cancel</button>
                                            <button class="p-button--positive u-no-margin--top"
                                                data-ng-click="addBond()"
                                                data-ng-disabled="cannotAddBond()">Save</button>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            <tr class="is-active" data-ng-if="isShowingCreateBridge() && !isAllNetworkingDisabled()">
                                <td class="col-1">
                                    <input type="checkbox" class="checkbox" id="bond-create" disabled="disabled" checked />
                                    <label for="bridge-create"></label>
                                </td>
                                <td class="col-2">
                                    <input type="text" class="table__input editible"
                                        data-ng-class="{ 'is-error': isInterfaceNameInvalid(newBridgeInterface) }"
                                        data-ng-model="newBridgeInterface.name">
                                </td>
                                <td class="col-1">
                                    <input class="align-center" type="radio" id="{$ newBridgeInterface $}" name="bridgeBootInterface" checked
                                        data-ng-if="hasBootInterface(newBridgeInterface)">
                                    <label for="{$ newBridgeInterface $}"></label>
                                </td>
                                <td class="col-8"></td>
                                <td class="p-table-expanding__panel col-12" data-ng-if="isShowingCreateBridge() && !isAllNetworkingDisabled()">
                                    <div class="row" data-ng-if="windowWidth <= 768">
                                        <div class="col-6">
                                            <h2 data-ng-click="cancel()" class="u-float--left">&lsaquo;&nbsp;&nbsp;
                                                Create bridge
                                            </h2>
                                        </div>
                                        <div class="col-6 u-align--right">
                                            <button data-ng-click="cancel()" class="p-button--base">
                                                <i class="p-icon--close">Cancel</i>
                                            </button>
                                        </div>
                                    </div>
                                    <div class="p-form p-form--stacked">
                                        <div class="row">
                                            <div class="col-6">
                                                <div class="p-form__group u-hide--large">
                                                    <label for="bridge-name" class="p-form__label">Name</label>
                                                    <div class="p-form__control">
                                                        <input type="text" id="bridge-name"
                                                            data-ng-class="{ 'is-error': isInterfaceNameInvalid(newBridgeInterface) }"
                                                            data-ng-model="newBridgeInterface.name">
                                                    </div>
                                                </div>
                                                <div class="p-form__group">
                                                    <label class="p-form__label">Primary</label>
                                                    <div class="p-form__control">
                                                        <span>{$ newBridgeInterface.primary.name $}</span>
                                                    </div>
                                                </div>
                                                <div class="p-form__group p-form-validation"
                                                    data-ng-class="{ 'is-error': isMACAddressInvalid(newBridgeInterface.mac_address) }">
                                                    <label for="mac" class="p-form__label">MAC address</label>
                                                    <div class="p-form__control">
                                                        <input type="text" name="mac" class="p-form-validation__input"
                                                            placeholder="00:00:00:00:00:00"
                                                            data-ng-model="newBridgeInterface.mac_address"
                                                            data-ng-pattern="/^([0-9A-F]{2}[::]){5}([0-9A-F]{2})$/gmi" mac-address maxlength="17"
                                                            data-ng-placeholder="getInterfacePlaceholderMACAddress(newBridgeInterface)">
                                                    </div>
                                                </div>
                                                <div class="p-form__group">
                                                    <label class="p-form__label">Tags</label>
                                                    <div class="p-form__control tags--inline">
                                                        <tags-input data-ng-model="newBridgeInterface.tags" allow-tags-pattern="[\w-]+"></tags-input>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-6">
                                                <div class="p-form__group">
                                                    <label for="stp" class="p-form__label">STP</label>
                                                    <div class="p-form__control">
                                                        <div class="onoffswitch">
                                                            <input input id="bridge_stp" type="checkbox" name="bridge_stp" class="onoffswitch-checkbox"
                                                                data-ng-model="newBridgeInterface.bridge_stp">
                                                            <label class="onoffswitch-label u-no-margin--top" for="bridge_stp">
                                                                <span class="onoffswitch-inner"></span>
                                                                <span class="onoffswitch-switch"></span>
                                                            </label>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="p-form__group" data-ng-if="newBridgeInterface.bridge_stp">
                                                    <label for="fd" class="p-form__label">Forward delay</label>
                                                    <div class="p-form__control">
                                                        <input type="text" name="mac"
                                                            data-ng-model="newBridgeInterface.bridge_fd">
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row is-active">
                                        <hr />
                                        <div class="col-12 u-align--right">
                                            <button class="p-button--base" data-ng-click="cancel()">Cancel</button>
                                            <button class="p-button--positive u-no-margin--top"
                                                data-ng-click="addBridge()"
                                                data-ng-disabled="cannotAddBridge()">Save</button>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            <tr class="is-active ng-hide" data-ng-show="isShowingCreatePhysical()">
                                <td class="col-2 p-form-validation" data-ng-if="!isDevice"
                                    data-ng-class="{ 'is-error': isInterfaceNameInvalid(newInterface) }">
                                    <input type="text" class="p-form-validation__input"
                                        data-ng-model="newInterface.name">
                                </td>
                                <td class="col-10"></td>
                                <td class="p-table-expanding__panel col-12">
                                    <div class="row" data-ng-if="windowWidth <= 768">
                                        <div class="col-8">
                                            <h2 data-ng-click="cancel()">&lsaquo;&nbsp;&nbsp;New interface</h2>
                                        </div>
                                        <div class="col-4 u-align--right">
                                            <i data-ng-click="cancel()" class="p-icon--close">Cancel</i>
                                        </div>
                                    </div>
                                    <div class="p-form p-form--stacked" data-ng-if="!isDevice">
                                        <div class="row">
                                            <div class="col-6" data-ng-if="!isDevice">
                                                <div class="p-form__group p-form-validation u-hide--large"
                                                    data-ng-class="{ 'is-error': isInterfaceNameInvalid(newInterface) }">
                                                    <label for="new-interface-name" class="p-form__label">Name</label>
                                                    <div class="p-form__control">
                                                        <input type="text" class="p-form-validation__input" id="new-interface-name"
                                                            data-ng-model="newInterface.name">
                                                    </div>
                                                </div>
                                                <div class="p-form__group">
                                                    <label class="p-form__label">Type</label>
                                                    <div class="p-form__control">
                                                        <span>Physical</span>
                                                    </div>
                                                </div>
                                                <div class="p-form__group p-form-validation"
                                                    data-ng-class="{ 'is-error': isMACAddressInvalid(newInterface.mac_address, false) || newInterface.macError }">
                                                    <label for="mac" class="p-form__label">MAC address</label>
                                                    <div class="p-form__control">
                                                        <input type="text" name="mac" class="p-form-validation__input"
                                                            placeholder="00:00:00:00:00:00"
                                                            data-ng-model="newInterface.mac_address"
                                                            data-ng-pattern="/^([0-9A-F]{2}[::]){5}([0-9A-F]{2})$/gmi" mac-address maxlength="17">
                                                    </div>
                                                </div>
                                                <div class="p-form__group">
                                                    <label class="p-form__label">Tags</label>
                                                    <div class="p-form__control tags--inline">
                                                        <tags-input data-ng-model="newInterface.tags" allow-tags-pattern="[\w-]+"></tags-input>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-6">
                                                <div class="p-form__group">
                                                    <label for="fabric" class="p-form__label">Fabric</label>
                                                    <div class="p-form__control">
                                                        <select name="fabric"
                                                            data-ng-model="newInterface.fabric"
                                                            data-ng-change="fabricChanged(newInterface)"
                                                            data-ng-options="fabric as fabric.name for fabric in fabrics">
                                                        </select>
                                                    </div>
                                                </div>
                                                <div class="p-form__group">
                                                    <label for="vlan" class="p-form__label">VLAN</label>
                                                    <div class="p-form__control">
                                                        <select name="vlan"
                                                            data-ng-model="newInterface.vlan"
                                                            data-ng-options="vlan as getVLANText(vlan) for vlan in vlans"
                                                            disabled="disabled">
                                                        </select>
                                                    </div>
                                                </div>
                                                <div class="p-form__group">
                                                    <label for="subnet" class="p-form__label">Subnet</label>
                                                    <div class="p-form__control">
                                                        <select name="subnet"
                                                            data-ng-model="newInterface.subnet"
                                                            data-ng-change="subnetChanged(newInterface)"
                                                            data-ng-options="subnet as getSubnetText(subnet) for subnet in subnets | filterByVLAN:newInterface.vlan">
                                                            <option value="" data-ng-hide="newInterface.type === 'alias'">Unconfigured</option>
                                                        </select>
                                                    </div>
                                                </div>
                                                <div class="p-form__group" data-ng-if="!isLinkModeDisabled(newInterface)">
                                                    <label for="link-mode" class="p-form__label">IP mode</label>
                                                    <div class="p-form__control">
                                                        <select name="link-mode"
                                                            data-ng-model="newInterface.mode"
                                                            data-ng-change="modeChanged(newInterface)"
                                                            data-ng-options="mode.mode as mode.text for mode in modes | filterLinkModes:newInterface">
                                                        </select>
                                                    </div>
                                                </div>
                                                <div class="p-form__group p-form-validation" data-ng-if="newInterface.mode == 'static'"
                                                    data-ng-class="{ 'is-error': isIPAddressInvalid(newInterface) }">
                                                    <label for="ip-address" class="p-form__label">IP address</label>
                                                    <div class="p-form__control">
                                                        <input name="ip-address" type="text"
                                                            class="p-form-validation__input"
                                                            placeholder="IP address (optional)"
                                                            data-ng-model="newInterface.ip_address">
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="p-form p-form--stacked u-no-margin--top">
                                        <div class="row" data-ng-if="isDevice">
                                            <div class="col-6">
                                                <div class="p-form__group p-form-validation"
                                                    data-ng-class="{ 'is-error': isMACAddressInvalid(newInterface.mac_address, true) }">
                                                    <label for="mac" class="p-form__label">MAC address</label>
                                                    <div class="p-form__control">
                                                        <input name="mac" type="text"
                                                            class="p-form-validation__input"
                                                            placeholder="00:00:00:00:00:00"
                                                            data-ng-model="newInterface.mac_address"
                                                            data-ng-pattern="/^([0-9A-F]{2}[::]){5}([0-9A-F]{2})$/gmi" mac-address maxlength="17">
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-6" data-ng-if="!isAllNetworkingDisabled(interface)">
                                                <div class="p-form__group">
                                                    <label for="ip-assignment" class="p-form__label">IP Assignment</label>
                                                    <div class="p-form__control">
                                                        <select name="ip-assignment"
                                                            data-ng-model="newInterface.ip_assignment"
                                                            data-ng-options="assignment.name as assignment.text for assignment in ipAssignments">
                                                        </select>
                                                    </div>
                                                </div>
                                                <div class="p-form__group" data-ng-if="newInterface.ip_assignment === 'static'">
                                                    <label for="subnet" class="p-form__label">Subnet</label>
                                                    <div class="p-form__control">
                                                        <select name="subnet"
                                                            data-ng-init="newInterface.subnet = subnets[0]"
                                                            data-ng-model="newInterface.subnet"
                                                            data-ng-change="subnetChanged(newInterface)"
                                                            data-ng-options="subnet as getSubnetText(subnet) for subnet in subnets">
                                                        </select>
                                                    </div>
                                                </div>
                                                <div class="p-form__group p-form-validation" data-ng-if="newInterface.ip_assignment !== 'dynamic'"
                                                    data-ng-class="{ 'is-error': isIPAddressInvalid(newInterface) }">
                                                    <label for="ip-address" class="p-form__label">IP address</label>
                                                    <div class="p-form__control">
                                                        <input name="ip-address" type="text"
                                                            class="p-form-validation__input"
                                                            data-ng-if="newInterface.ip_assignment === 'static'"
                                                            placeholder="IP address (optional)"
                                                            data-ng-model="newInterface.ip_address">
                                                        <input name="ip-address" type="text"
                                                            class="p-form-validation__input"
                                                            data-ng-if="newInterface.ip_assignment !== 'static'"
                                                            placeholder="IP address"
                                                            data-ng-model="newInterface.ip_address">
                                                        <p class="p-form-validation__message" role="alert"
                                                            data-ng-if="getInterfaceError(newInterface)">
                                                            <strong>Error:</strong> {$ getInterfaceError(newInterface) $}
                                                        </p>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <hr />
                                        <div class="u-float--left" data-ng-show="newInterface.errorMsg">
                                            <span class="p-icon--error">Error:</span> {$ newInterface.errorMsg $}
                                        </div>
                                        <div class="u-float--right u-no-margin--top">
                                            <button class="p-button--base" data-ng-click="cancel()">Cancel</button>
                                            <button class="p-button--positive u-no-margin--top"
                                                data-ng-click="addPhysicalInterface()"
                                                data-ng-disabled="cannotAddPhysicalInterface()">Save</button>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="row">
                    <div data-ng-if="!isController && !isDevice" data-ng-hide="isAllNetworkingDisabled() || isShowingCreateBond() || isShowingCreatePhysical()">
                        <button class="p-button--neutral"
                            data-ng-disabled="selectedMode !== null"
                            data-ng-click="showCreatePhysical()">Add interface</button>
                        <button class="p-button--neutral"
                            data-ng-disabled="!canCreateBond()"
                            data-ng-click="showCreateBond()">Create bond</button>
                        <button class="p-button--neutral"
                            data-ng-disabled="!canCreateBridge()"
                            data-ng-click="showCreateBridge()">Create bridge</button>
                    </div>
                    <div data-ng-if="isDevice" data-ng-hide="isAllNetworkingDisabled() || isShowingCreateBond() || isShowingCreatePhysical()">
                        <button class="p-button--neutral"
                            data-ng-disabled="selectedMode !== null"
                            data-ng-click="showCreatePhysical()">Add interface</button>
                    </div>
                </div>
            </form>
        </div>
    </section>
    <section class="p-strip" data-ng-if="section.area === 'storage'">
        <form data-ng-controller="NodeStorageController">
            <div class="row">
                <div class="col-12">
                    <div class="p-notification--negative ng-hide" data-ng-hide="has_disks">
                        <p class="p-notification__response">
                            <span class="p-notification__status">Error:</span> No storage information. Commissioning this node will gather the storage information.
                        </p>
                    </div>
                    <div class="p-notification ng-hide" data-ng-show="isAllStorageDisabled() && isSuperUser()">
                        <p class="p-notification__response">Storage configuration cannot be modified unless the node is Ready or Allocated.</p>
                    </div>
                    <div class="p-notification ng-hide" data-ng-show="isAllStorageDisabled() && !isSuperUser()">
                        <p class="p-notification__response">Storage configuration cannot be modified unless the node is Ready or Allocated and you own the node.</p>
                    </div>
                    <div class="p-notification ng-hide" data-ng-show="!isUbuntuOS()">
                        <p class="p-notification__response">Custom storage configuration only supported on Ubuntu. Using flat layout.</p>
                    </div>
                    <div data-ng-repeat="issue in node.storage_layout_issues" class="p-notification--negative ng-hide" data-ng-show="hasStorageLayoutIssues()">
                        <p class="p-notification__response">
                            <span class="p-notification__status">Error:</span> {$ issue $}
                        </p>
                    </div>
                </div>
            </div>
            <div class="row">
                <div data-ng-controller="NodeFilesystemsController">
                    <h3>File systems</h3>
                    <table class="p-table-expanding">
                        <thead>
                            <tr>
                                <th class="col-3">Name</th>
                                <th class="col-1">Size</th>
                                <th class="col-2">File system</th>
                                <th class="col-3">Mount point</th>
                                <th class="col-2">Mount options</th>
                                <th class="col-1"><div class="u-align--center">Actions</div></th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr data-ng-hide="filesystems.length">
                                <td class="col-12">
                                    No filesystems defined.
                                </td>
                            </tr>
                            <tr data-ng-repeat="filesystem in filesystems" data-ng-class="{ 'is-active': filesystem.$selected }">
                                <td class="col-3" aria-label="Name">{$ filesystem.name $}</td>
                                <td class="col-1" aria-label="Size">{$ filesystem.size_human $}</td>
                                <td class="col-2" aria-label="File system">{$ filesystem.fstype $}</td>
                                <td class="col-3" aria-label="Mount point">{$ filesystem.mount_point $}</td>
                                <td class="col-2" aria-label="Mount options">{$ filesystem.mount_options $}</td>
                                <td class="col-1">
                                    <div class="u-align--right">
                                        <div class="p-contextual-menu" toggle-ctrl data-ng-if="!isAllStorageDisabled()">
                                            <button class="p-button--base p-contextual-menu__toggle" aria-controls="#{$ item.name $}-menu"
                                                data-ng-click="toggleMenu()" aria-haspopup="true"><i class="p-icon--contextual-menu"></i></button>
                                            <div class="p-contextual-menu__dropdown" role="menu" data-ng-show="isToggled" id="{$ item.name $}-menu">
                                                <a href="" class="p-contextual-menu__link"
                                                aria-label="Unmount" data-ng-click="toggleMenu(); quickFilesystemUnmount(filesystem)"
                                                data-ng-show="!isAllStorageDisabled() && usesStorage(filesystem.fstype)">Unmount</a>
                                                <a href="" class="p-contextual-menu__link"
                                                aria-label="Remove" data-ng-click="toggleMenu(); quickFilesystemDelete(filesystem)"
                                                data-ng-show="!isAllStorageDisabled()">Remove&hellip;</a>
                                            </div>
                                        </div>
                                    </div>
                                </td>
                                <td class="p-table-expanding__panel col-12" data-ng-if="filesystemMode === 'unmount' || filesystemMode === 'delete'">
                                    <div class="row" data-ng-if="windowWidth <= 768">
                                        <div class="col-8">
                                            <h2 data-ng-click="filesystemCancel()">
                                                <span data-ng-if="filesystemMode === 'unmount'">Unmounting {$ filesystem.name $}</span>
                                                <span data-ng-if="filesystemMode === 'delete'">Removing {$ filesystem.name $}</span>
                                            </h2>
                                        </div>
                                        <div class="col-4 u-align--right">
                                            <button data-ng-click="filesystemCancel()" class="p-icon--close">Cancel</button>
                                        </div>
                                    </div>
                                    <div data-ng-if="filesystemMode !== null && filesystemMode !== 'multi'" data-ng-class="{ 'is-active': filesystemMode !== null && filesystemMode !== 'multi' }">
                                        <div class="row" data-ng-if="filesystemMode === 'unmount'">
                                            <div class="col-8">
                                                <p><span class="p-icon--warning">Warning:</span> Are you sure you want to unmount this filesystem?</p>
                                            </div>
                                            <div class="col-4 u-align--right">
                                                <button class="p-button--base" type="button" data-ng-click="filesystemCancel()">Cancel</button>
                                                <button class="p-button--neutral u-no-margin--top" data-ng-click="filesystemConfirmUnmount(filesystem)">Unmount</button>
                                            </div>
                                        </div>
                                        <div data-ng-if="filesystemMode === 'delete'">
                                            <div class="col-8">
                                                <p><span class="p-icon--warning">Warning:</span> Are you sure you want to remove this {$ getRemoveTypeText(filesystem) $}?</p>
                                            </div>
                                            <div class="col-4 u-align--right">
                                                <button class="p-button--base" type="button" data-ng-click="filesystemCancel(filesystem)">Cancel</button>
                                                <button class="p-button--negative u-no-margin--top" data-ng-click="filesystemConfirmDelete(filesystem)">Remove</button>
                                            </div>
                                        </div>
                                    </div>
                                </td>
                            </tr>

                            <tr class="is-active" data-ng-if="dropdown" data-ng-switch="dropdown">
                                <!-- Adding a new TMPFS or RAMFPS file system -->
                                <td class="p-table-expanding__panel col-12" data-ng-controller="NodeAddSpecialFilesystemController" data-ng-switch-when="special">
                                    <div class="row" data-ng-if="windowWidth <= 768">
                                        <div class="col-8">
                                            <h2 data-ng-click="cancel()">Adding filesystem</h2>
                                        </div>
                                        <div class="col-4 u-align--right">
                                            <i data-ng-click="cancel()" class="p-icon--close">Cancel</i>
                                        </div>
                                    </div>
                                    <div class="row p-form p-form--stacked">
                                        <div class="col-6">
                                            <div class="p-form__group">
                                                <label class="p-form__label">Description</label>
                                                <div class="p-form__control">
                                                    <span data-ng-bind="description"></span>
                                                </div>
                                            </div>
                                            <div class="p-form__group">
                                                <label for="file-sys" class="p-form__label">Filesystem</label>
                                                <div class="p-form__control">
                                                    <select name="type" id="type" data-ng-model="filesystem.fstype">
                                                        <option value="" disabled="disabled">Select type</option>
                                                        <option value="tmpfs">tmpfs</option>
                                                        <option value="ramfs">ramfs</option>
                                                    </select>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-6">
                                            <div class="p-form__group p-form-validation u-no-margin--top"
                                                data-ng-class="{ 'is-error': isMountPointInvalid(filesystem.mountPoint) }">
                                                <label class="p-form__label" for="mount-point">Mount point</label>
                                                <div class="p-form__control">
                                                    <input type="text" id="mount-point" class="p-form-validation__input"
                                                        placeholder="Absolute path" data-ng-model="filesystem.mountPoint">
                                                </div>
                                            </div>
                                            <div class="p-form__group">
                                                <label for="mount-options" class="p-form__label">Mount options</label>
                                                <div class="p-form__control">
                                                    <input type="text" id="mount-options"
                                                        placeholder="Separated by commas, no spaces" data-ng-model="filesystem.mountOptions">
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row u-no-margin--top">
                                        <hr />
                                        <div class="u-align--right u-no-margin--top">
                                            <button class="p-button--base" type="button"
                                                data-ng-click="cancel()">Cancel</button>
                                            <button class="p-button--neutral u-no-margin--top ng-binding"
                                                data-ng-disabled="!canMount()"
                                                data-ng-click="mount()">Mount</button>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <button class="p-button--neutral p-tooltip--top-center"
                        data-ng-disabled="dropdown !== null"
                        data-ng-class="{ 'p-tooltip': dropdown === null}"
                        data-ng-if="!isAllStorageDisabled()"
                        data-ng-click="addSpecialFilesystem()">
                        Add special filesystem
                        <span class="p-tooltip__message" role="tooltip">Create a tmpfs or ramfs filesystem</span>
                    </button>
                </div>
                <div data-ng-show="cachesets.length">
                    <div class="row">
                        <h3>Available cache sets</h3>
                    </div>
                    <div class="row">
                        <table class="p-table-expanding">
                            <thead>
                                <tr>
                                    <th class="col-1"></th>
                                    <th class="col-2">Name</th>
                                    <th class="col-3">Size</th>
                                    <th class="col-4">Used by</th>
                                    <th class="col-2 u-align--right">Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr data-ng-repeat="cacheset in cachesets" data-ng-class="{ 'is-active': cacheset.$selected }">
                                    <td class="col-1 u-hide u-show--large"></td>
                                    <td class="col-2" aria-label="Name">{$ cacheset.name $}</td>
                                    <td class="col-3" aria-label="Size">{$ cacheset.size_human $}</td>
                                    <td class="col-4" aria-label="Used by">{$ cacheset.used_by $}</td>
                                    <td class="col-2">
                                        <div toggle-ctrl data-ng-if="canDeleteCacheSet(cacheset)">
                                            <button class="p-button" aria-label="Remove"
                                                data-ng-show="canDeleteCacheSet(cacheset)"
                                                data-ng-click="toggleMenu(); quickCacheSetDelete(cacheset)">Remove cacheset</button>
                                        </div>
                                    </td>
                                    <td class="p-table-expanding__panel col-12" data-ng-if="cachesetsMode === 'delete'">
                                        <div class="row" data-ng-if="windowWidth <= 768">
                                            <div class="col-8">
                                                <h2 data-ng-click="filesystemCancel()">
                                                    <span data-ng-if="cachesetsMode === 'delete'">Removing {$ cacheset.name $}</span>
                                                </h2>
                                            </div>
                                            <div class="col-4 u-aling--right">
                                                <i data-ng-click="filesystemCancel()" class="p-icon--close">Cancel</i>
                                            </div>
                                        </div>
                                        <div class="row" data-ng-class="{ 'is-active': cachesetsMode !== null && cachesetsMode !== 'multi' }">
                                            <div data-ng-show="cachesetsMode === 'single' && canDeleteCacheSet(cacheset)">
                                                <button class="p-button--base"
                                                    data-ng-show="canDeleteCacheSet(cacheset)"
                                                    data-ng-click="cacheSetDelete()">Remove</button>
                                            </div>
                                            <div class="row ng-hide" data-ng-show="cachesetsMode === 'delete'">
                                                <div class="col-8">
                                                    <p><span class="p-icon--warning">Warning:</span> Are you sure you want to delete this cache set?</p>
                                                </div>
                                                <div class="col-4 u-align--right">
                                                    <button class="p-button--base" type="button" data-ng-click="cacheSetCancel()">Cancel</button>
                                                    <button class="p-button--negative u-no-margin--top" data-ng-click="cacheSetConfirmDelete(cacheset)">Remove</button>
                                                </div>
                                            </div>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="p-strip">
                    <div class="row">
                        <h3>Available disks and partitions</h3>
                    </div>
                    <div class="row">
                        <table class="p-table-expanding">
                            <thead>
                                <tr>
                                    <th class="col-2">
                                        <input type="checkbox" class="checkbox u-float--left" id="available-check-all"
                                            data-ng-hide="isAvailableDisabled()"
                                            data-ng-checked="availableAllSelected"
                                            data-ng-click="toggleAvailableAllSelect()"
                                            data-ng-disabled="isAvailableDisabled()" />
                                        <label for="available-check-all"></label>
                                        <a data-ng-click="tableInfo.column = 'name'" data-ng-class="{'p-link--soft': tableInfo.column === 'name'}">Name</a>
                                        <span class="divide"> | </span>
                                        <a data-ng-click="tableInfo.column = 'model'" data-ng-class="{'p-link--soft': tableInfo.column === 'model'}">Model</a>
                                        <span class="divide"> | </span>
                                        <a data-ng-click="tableInfo.column = 'serial'" data-ng-class="{'p-link--soft': tableInfo.column === 'serial'}">Serial</a>
                                    </th>
                                    <th class="col-2">Fireware version</th>
                                    <th class="col-1"><div class="u-align--center">Boot</div></th>
                                    <th class="col-1">Size</th>
                                    <th class="col-1">Device Type</th>
                                    <th class="col-1">Filesystem</th>
                                    <th class="col-2">Tags</th>
                                    <th class="col-1">Health</th>
                                    <th class="col-1"><div class="u-align--center">Actions</div></th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr data-ng-hide="available.length">
                                    <td colspan="9" class="col-12">
                                        No available disks or partitions.
                                    </td>
                                </tr>
                                <tr data-ng-repeat="item in available | removeAvailableByNew:availableNew"
                                    data-ng-class="{ 'is-active': item.$selected }">
                                    <td class="col-2 p-form-validation" aria-label="Name"
                                        data-ng-class="{ 'is-error': isNameInvalid(item) }">
                                        <input type="checkbox" class="checkbox u-float--left" id="{$ item.name $}"
                                            data-ng-hide="isAvailableDisabled()"
                                            data-ng-checked="item.$selected"
                                            data-ng-click="toggleAvailableSelect(item)"
                                            data-ng-disabled="isAvailableDisabled()" />
                                        <label for="{$ item.name $}" ></label>
                                        <span data-ng-show="tableInfo.column === 'name'" data-ng-hide="availableMode === 'edit' && item.$selected">{$ item.name $}</span>
                                        <span data-ng-show="tableInfo.column === 'model'">{$ item.model $}</span>
                                        <span data-ng-show="tableInfo.column === 'serial'">{$ item.serial $}</span>
                                        <input type="text" class="p-form-validation__input"
                                            data-ng-model="item.name"
                                            data-ng-show="availableMode === 'edit' && item.$selected"
                                            data-ng-disabled="item.type === 'partition' || isAllStorageDisabled() || !isSuperUser()"
                                            data-ng-change="nameHasChanged(item)">
                                    </td>
                                    <td class="col-2" aria-label="Firmware Version">{$ item.firmware_version $}</td>
                                    <td class="col-1" aria-label="Boot">
                                        <div class="u-align--center">
                                            <input type="radio" name="boot-disk" id="{$ item.name $}-boot" class="u-no-margin--right"
                                                data-ng-click="setAsBootDisk(item)"
                                                data-ng-checked="item.is_boot"
                                                data-ng-if="item.type === 'physical'"
                                                data-ng-disabled="isBootDiskDisabled(item, 'available')"
                                                data-ng-hide="availableMode === 'edit' && item.$selected">
                                            <label for="{$ item.name $}-boot" data-ng-hide="availableMode === 'edit' && item.$selected"></label>
                                        </div>
                                    </td>
                                    <td class="col-1" aria-label="Size">
                                        <span data-ng-hide="availableMode === 'edit' && item.$selected">
                                            {$ item.size_human $} <span class="table__label ng-hide" data-ng-show="showFreeSpace(item)">Free: {$ item.available_size_human $}</span>
                                        </span>
                                    </td>
                                    <td class="col-1" aria-label="Device type">
                                        <span data-ng-hide="availableMode === 'edit' && item.$selected">{$ getDeviceType(item) $}</span>
                                    </td>
                                    <td class="col-1" aria-label="Filesystem">
                                        <span data-ng-hide="availableMode === 'edit' && item.$selected">{$ item.fstype $}</span>
                                    </td>
                                    <td class="col-2" aria-label="Tags">
                                        <span class="table__tag" data-ng-repeat="tag in item.tags" data-ng-hide="item.$options.editingTags">
                                            <a href="#/node/?query=storage_tags:({$ tag.text $})">{$ tag.text $}</a>
                                        </span>
                                    </td>
                                    <td class="col-1" aria-label="Health">
                                        <span data-maas-script-status="script-status" data-script-status="item.test_status" data-ng-if="item.type === 'physical'"></span>
                                        <span data-ng-if="item.test_status === 0 || item.test_status === 1 || item.test_status === 2 || item.test_status === 5 || item.test_status === 7">Ok</span>
                                        <span data-ng-if="item.test_status === 3 || item.test_status === 4 || item.test_status === 8">Error</span>
                                        <span data-ng-if="item.test_status === 6">Degraded</span>
                                        <span data-ng-if="item.test_status === -1">Unknown</span>
                                    </td>
                                    <td class="col-1 u-align--right">
                                        <div class="p-contextual-menu" toggle-ctrl
                                            data-ng-if="canAddLogicalVolume(item) || canAddPartition(item) || canEdit(item) || canDelete(item)">
                                            <button class="p-contextual-menu__toggle p-button--base" aria-controls="#{$ item.name $}-menu"
                                                data-ng-click="toggleMenu()" aria-haspopup="true"><i class="p-icon--contextual-menu u-no-margin--right">Actions</i></button>
                                            <div class="p-contextual-menu__dropdown" role="menu" data-ng-show="isToggled" id="{$ item.name $}-menu">
                                                <a href="" class="p-contextual-menu__link"
                                                    aria-label="Add logical volume"
                                                    data-ng-show="canAddLogicalVolume(item)"
                                                    data-ng-click="toggleMenu(); availableLogicalVolume(item)">Add logical volume</a>
                                                <a href="" class="p-contextual-menu__link"
                                                    aria-label="Partition"
                                                    data-ng-show="canAddPartition(item)"
                                                    data-ng-click="toggleMenu(); availableQuickPartition(item)">Add partition</a>
                                                <a href="" class="p-contextual-menu__link"
                                                    aria-label="Edit"
                                                    data-ng-show="canEdit(item)"
                                                    data-ng-click="toggleMenu(); availableQuickEdit(item)">Edit disk</a>
                                                <a href="" class="p-contextual-menu__link"
                                                    aria-label="Remove"
                                                    data-ng-show="canDelete(item)"
                                                    data-ng-click="toggleMenu(); availableQuickDelete(item)">Remove disk&hellip;</a>
                                            </div>
                                        </div>
                                    </td>
                                    <td class="p-table-expanding__panel col-12"
                                        data-ng-if="(availableMode === 'edit' || availableMode === 'format-mount' || availableMode === 'partition' || availableMode === 'logical-volume' || availableMode === 'delete') && item.$selected">
                                        <div class="row" data-ng-if="windowWidth <= 768">
                                            <div class="col-8">
                                                <h2 data-ng-click="availableCancel(item)">
                                                    <span data-ng-if="availableMode === 'edit'">Editing {$ item.name $}</span>
                                                    <span data-ng-if="availableMode === 'format-mount'">Mount device</span>
                                                    <span data-ng-if="availableMode === 'partition'">Adding partition</span>
                                                    <span data-ng-if="availableMode === 'logical-volume'">Adding logical volume</span>
                                                    <span data-ng-if="availableMode === 'delete'">Removing {$ item.name $}</span>
                                                </h2>
                                            </div>
                                            <div class="col-4 u-align--right">
                                                <i data-ng-click="availableCancel(item)" class="p-icon--close">Cancel</i>
                                            </div>
                                        </div>
                                        <div class="row p-form p-form--stacked" data-ng-if="availableMode === 'edit'">
                                            <div class="col-6">
                                                <div class="p-form__group p-form-validation u-hide--large" data-ng-show="availableMode === 'edit' && item.$selected"
                                                    data-ng-class="{ 'is-error': isNameInvalid(item) }">
                                                    <label class="p-form__label" for="device-name" data-ng-show="availableMode === 'edit' && item.$selected">Name</label>
                                                    <div class="p-form__control">
                                                        <input type="text" id="device-name" class="p-form-validation__input"
                                                            data-ng-model="item.name"
                                                            data-ng-show="availableMode === 'edit' && item.$selected"
                                                            data-ng-disabled="item.type === 'partition' || isAllStorageDisabled() || !isSuperUser()"
                                                            data-ng-change="nameHasChanged(item)">
                                                    </div>
                                                </div>
                                                <div class="p-form__group">
                                                    <label class="p-form__label">Size</label>
                                                    <div class="p-form__control">
                                                        <span>{$ item.size_human $}</span>
                                                    </div>
                                                </div>
                                                <div class="p-form__group ng-hide" data-ng-show="showFreeSpace(item)">
                                                    <label class="p-form__label">Free space</label>
                                                    <div class="p-form__control">
                                                        <span>{$ item.available_size_human $}</span>
                                                    </div>
                                                </div>
                                                <div class="p-form__group">
                                                    <label class="p-form__label">Type</label>
                                                    <div class="p-form__control">
                                                        <span>{$ getDeviceType(item) $}</span>
                                                    </div>
                                                </div>
                                                <div class="p-form__group" data-ng-if="item.$options.editingTags">
                                                    <label for="tags" class="p-form__label">Tags</label>
                                                    <div class="p-form__control tags--inline">
                                                        <tags-input data-ng-model="item.$options.tags" data-ng-if="item.$options.editingTags" allow-tags-pattern="[\w-]+"></tags-input>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-6" data-ng-show="item.$options.editingFilesystem">
                                                <div class="p-form__group">
                                                    <label for="filesys" class="p-form__label">Filesystem</label>
                                                    <div class="p-form__controls">
                                                        <select name="filesys"
                                                            data-ng-model="item.$options.fstype"
                                                            data-ng-change="fstypeChanged(item.$options)"
                                                            data-ng-options="fs.key as fs.key for fs in node.supported_filesystems">
                                                            <option value="" selected="selected">Unformatted</option>
                                                        </select>
                                                    </div>
                                                </div>
                                                <div class="p-form__group p-form-validation"
                                                    data-ng-class="{ 'is-error': isMountPointInvalid(item.$options.mountPoint) }">
                                                    <label for="mount-point" class="p-form__label">Mount point</label>
                                                    <div class="p-form__controls">
                                                        <input type="text" id="mount-point" class="p-form-validation__input"
                                                            placeholder="Absolute path"
                                                            data-ng-model="item.$options.mountPoint"
                                                            data-ng-disabled="!usesMountPoint(item.$options.fstype)">
                                                    </div>
                                                </div>
                                                <div class="p-form__group">
                                                    <label for="mount-options" class="p-form__label">Mount options</label>
                                                    <div class="p-form__controls">
                                                        <input type="text" id="mount-options"
                                                            placeholder="Separated by commas, no spaces"
                                                            data-ng-model="item.$options.mountOptions"
                                                            data-ng-disabled="item.$options.fstype === null">
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row p-form p-form--stacked"
                                            data-ng-if="availableMode === 'format-mount'"
                                            data-ng-class="{ 'is-active': availableMode === 'format-mount' }">
                                            <div class="col-6">
                                                <div class="p-form__group">
                                                    <label class="p-form__label">Size</label>
                                                    <div class="p-form__controls">
                                                        <span>{$ item.size_human $} <span class="ng-hide" data-ng-show="showFreeSpace(item)">Free: {$ item.available_size_human $}</span></span>
                                                    </div>
                                                </div>
                                                <div class="p-form__group">
                                                    <label class="p-form__label">Type</label>
                                                    <div class="p-form__controls">
                                                        <span>{$ getDeviceType(item) $}</span>
                                                    </div>
                                                </div>
                                                <div class="p-form__group">
                                                    <label for="tags" class="p-form__label">Tags</label>
                                                    <div class="p-form__controls">
                                                        <input type="text" id="tags" name="tags">
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-6">
                                                <div class="p-form__group">
                                                    <label for="filesys" class="p-form__label">Filesystem</label>
                                                    <div class="p-form__controls">
                                                        <select name="filesys"
                                                            data-ng-model="item.$options.fstype"
                                                            data-ng-change="fstypeChanged(item.$options)"
                                                            data-ng-options="fs.key as fs.key for fs in node.supported_filesystems">
                                                            <option value="">Unformatted</option>
                                                        </select>
                                                    </div>
                                                </div>
                                                <div class="p-form__group p-form-validation"
                                                    data-ng-class="{ 'is-error': isMountPointInvalid(item.$options.mountPoint) }">
                                                    <label for="mount-point" class="p-form__label">Mount point</label>
                                                    <div class="p-form__controls">
                                                        <input type="text" id="mount-point" class="p-form-validation__input"
                                                            placeholder="Absolute path"
                                                            data-ng-model="item.$options.mountPoint"
                                                            data-ng-disabled="!usesMountPoint(item.$options.fstype)">
                                                    </div>
                                                </div>
                                                <div class="p-form__group">
                                                    <label for="mount-options" class="p-form__label">Mount options</label>
                                                    <div class="p-form__controls">
                                                        <input type="text" id="mount-options"
                                                            placeholder="Separated by commas, no spaces"
                                                            data-ng-model="item.$options.mountOptions"
                                                            data-ng-disabled="item.$options.fstype === null">
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row p-form p-form--stacked"
                                            data-ng-if="availableMode === 'partition'"
                                            data-ng-class="{ 'is-active': availableMode === 'partition' }">
                                            <div class="col-6">
                                                <div class="p-form__group">
                                                    <label for="mount-options" class="p-form__label">Name</label>
                                                    <div class="p-form__controls">
                                                        <span>{$ getAddPartitionName(item) $}</span>
                                                    </div>
                                                </div>
                                                <div class="p-form__group">
                                                    <label for="mount-options" class="p-form__label">Type</label>
                                                    <div class="p-form__controls">
                                                        <span>Partition</span>
                                                    </div>
                                                </div>
                                                <div class="p-form__group p-form-validation"
                                                    data-ng-class="{ 'is-error': isAddPartitionSizeInvalid(item) }">
                                                    <label class="p-form__label" for="size">Size</label>
                                                    <div class="p-form__controls">
                                                        <input type="text" id="size" data-ng-model="item.$options.size"
                                                            class="p-form-validation__input">
                                                        <select name="size-units" class="p-form-validation__input"
                                                            data-ng-model="item.$options.sizeUnits">
                                                            <option value="MB">MB</option>
                                                            <option value="GB">GB</option>
                                                            <option value="TB">TB</option>
                                                        </select>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-6">
                                                <div class="p-form__group">
                                                    <label class="p-form__label" for="filesys">Filesystem</label>
                                                    <div class="p-form__controls">
                                                        <select name="filesys" id="filesys"
                                                            data-ng-model="item.$options.fstype"
                                                            data-ng-change="fstypeChanged(item.$options)"
                                                            data-ng-options="fs.key as fs.key for fs in node.supported_filesystems">
                                                            <option value="">Unformatted</option>
                                                        </select>
                                                    </div>
                                                </div>
                                                <div class="p-form__group p-form-validation"
                                                    data-ng-class="{ 'is-error': isMountPointInvalid(item.$options.mountPoint) }">
                                                    <label class="p-form__label" for="mount-point">Mount point</label>
                                                    <div class="p-form__controls">
                                                        <input type="text" id="mount-point"
                                                            placeholder="Absolute path" class="p-form-validation__input"
                                                            data-ng-model="item.$options.mountPoint"
                                                            data-ng-disabled="!usesMountPoint(item.$options.fstype)">
                                                    </div>
                                                </div>
                                                <div class="p-form__group">
                                                    <label class="p-form__label" for="mount-options">Mount options</label>
                                                    <div class="p-form__controls">
                                                        <input type="text" id="mount-options"
                                                            placeholder="Separated by commas, no spaces"
                                                            data-ng-model="item.$options.mountOptions"
                                                            data-ng-disabled="item.$options.fstype === null">
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row p-form p-form--stacked"
                                            data-ng-if="availableMode === 'logical-volume'"
                                            data-ng-class="{ 'is-active': availableMode === 'logical-volume' }">
                                            <div class="col-6">
                                                <div class="p-form__group p-form-validation"
                                                    data-ng-class="{ 'is-error': isLogicalVolumeNameInvalid(item) }">
                                                    <label for="name" class="p-form__label">Name</label>
                                                    <div class="p-form__controls">
                                                        <input type="text" class="p-form-validation__input"
                                                            data-ng-change="newLogicalVolumeNameChanged(item)"
                                                            data-ng-model="item.$options.name">
                                                    </div>
                                                </div>
                                                <div class="p-form__group p-form-validation"
                                                    data-ng-class="{ 'is-error': isAddLogicalVolumeSizeInvalid(item) }">
                                                    <label for="size" class="p-form__label">Size</label>
                                                    <div class="p-form__controls">
                                                        <input type="text" id="size"
                                                            class="p-form-validation__input"
                                                            data-ng-model="item.$options.size">
                                                        <select name="size-units"
                                                            data-ng-model="item.$options.sizeUnits"
                                                            class="p-form-validation__input">
                                                            <option value="MB">MB</option>
                                                            <option value="GB">GB</option>
                                                            <option value="TB">TB</option>
                                                        </select>
                                                    </div>
                                                </div>
                                                <dl>
                                                    <dt>Type</dt>
                                                    <dd>Logical volume</dd>
                                                </dl>
                                                <div class="p-form__group">
                                                    <label for="tags" class="p-form__label">Tags</label>
                                                    <div class="p-form__controls tags--inline">
                                                        <tags-input data-ng-model="item.$options.tags" allow-tags-pattern="[\w-]+"></tags-input>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-6">
                                                <div class="p-form__group">
                                                    <label for="filesys" class="p-form__label">Filesystem</label>
                                                    <div class="p-form__controls">
                                                        <select name="filesys"
                                                            data-ng-model="item.$options.fstype"
                                                            data-ng-change="fstypeChanged(item.$options)"
                                                            data-ng-options="fs.key as fs.key for fs in node.supported_filesystems">
                                                            <option value="">Unformatted</option>
                                                        </select>
                                                    </div>
                                                </div>
                                                <div class="p-form__group p-form-validation"
                                                    data-ng-class="{ 'is-error': isMountPointInvalid(item.$options.mountPoint) }">
                                                    <label for="mount-point" class="p-form__label">Mount point</label>
                                                    <div class="p-form__controls">
                                                        <input type="text" id="mount-point"
                                                            class="p-form-validation__input"
                                                            placeholder="Absolute path"
                                                            data-ng-model="item.$options.mountPoint"
                                                            data-ng-disabled="!usesMountPoint(item.$options.fstype)">
                                                    </div>
                                                </div>
                                                <div class="p-form__group">
                                                    <label for="mount-options" class="p-form__label">Mount options</label>
                                                    <div class="p-form__controls">
                                                        <input type="text" id="mount-options"
                                                            placeholder="Separated by commas, no spaces"
                                                            data-ng-model="item.$options.mountOptions"
                                                            data-ng-disabled="item.$options.fstype === null">
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div data-ng-if="availableMode !== null && activeMode !== 'multi'"
                                            data-ng-class="{ 'is-active': availableMode !== null && activeMode !== 'multi' }">
                                            <div data-ng-if="availableMode === 'edit'" class="row">
                                                <hr />
                                                <div class="col-12 u-align--right">
                                                    <button class="p-button--base" type="button" data-ng-click="availableCancel(item)">Cancel</button>
                                                    <button class="p-button--positive u-no-margin--top"
                                                        data-ng-disabled="isMountPointInvalid(item.$options.mountPoint) || isNameInvalid(item)"
                                                        data-ng-click="availableConfirmEdit(item)">Save</button>
                                                </div>
                                            </div>
                                            <div data-ng-if="availableMode === 'delete'" class="row">
                                                <div class="col-8">
                                                    <p><span class="p-icon--warning">Warning:</span> Are you sure you want to remove this {$ getRemoveTypeText(item) $}?</p>
                                                </div>
                                                <div class="col-4 u-align--right">
                                                    <button class="p-button--base" type="button" data-ng-click="availableCancel(item)">Cancel</button>
                                                    <button class="p-button--negative u-no-margin--top" data-ng-click="availableConfirmDelete(item)">Remove</button>
                                                </div>
                                            </div>
                                            <div data-ng-if="availableMode === 'partition'" class="row">
                                                <hr />
                                                <div class="col-12 u-align--right">
                                                    <button class="p-button--base" type="button" data-ng-click="availableCancel(item)">Cancel</button>
                                                    <button class="p-button--positive u-no-margin--top"
                                                        data-ng-disabled="isAddPartitionSizeInvalid(item) || isMountPointInvalid(item.$options.mountPoint)"
                                                        data-ng-click="availableConfirmPartition(item)">Add partition</button>
                                                </div>
                                            </div>
                                            <div data-ng-if="availableMode === 'logical-volume'" class="row">
                                                <hr />
                                                <div class="col-12 u-align--right">
                                                    <button class="p-button--base" type="button" data-ng-click="availableCancel(item)">Cancel</button>
                                                    <button class="p-button--positive u-no-margin--top"
                                                        data-ng-disabled="isLogicalVolumeNameInvalid(item) || isAddLogicalVolumeSizeInvalid(item) || isMountPointInvalid(item.$options.mountPoint)"
                                                        data-ng-click="availableConfirmLogicalVolume(item)">Add logical volume</button>
                                                </div>
                                            </div>
                                        </div>
                                    </td>
                                </tr>
                                <tr class="is-active" data-ng-if="availableMode === 'bcache'">
                                    <td class="col-1">
                                        <input type="checkbox" class="checkbox" id="bcache-create" disabled="disabled" checked />
                                        <label class="checkbox-label" for="bcache-create"></label>
                                    </td>
                                    <td class="col-2 p-form-validation"
                                        data-ng-class="{ 'is-error': isNewDiskNameInvalid() }">
                                        <input type="text" class="p-form-validation__input"
                                            data-ng-model="availableNew.name">
                                    </td>
                                    <td class="col-2"></td>
                                    <td class="col-2"></td>
                                    <td class="col-4"></td>
                                    <td class="col-1"></td>
                                    <td class="p-table-expanding__panel col-12">
                                        <div class="row" data-ng-if="windowWidth <= 768">
                                            <div class="col-8">
                                                <h2 data-ng-click="availableCancel()">Creating Bcache</h2>
                                            </div>
                                            <div class="col-4">
                                                <button data-ng-click="availableCancel()" class="p-button">
                                                    <i class="p-icon--close">Cancel</i>
                                                </button>
                                            </div>
                                        </div>
                                        <div class="p-form p-form--stacked">
                                            <div class="row">
                                                <div class="col-6">
                                                    <div class="p-form__group u-hide--large p-form-validation"
                                                        data-ng-class="{ 'is-error': isNewDiskNameInvalid() }">
                                                        <label for="bcache-name" class="p-form__label">Name</label>
                                                        <div class="p-form__controls">
                                                            <input type="text" id="bcache-name" data-ng-model="availableNew.name"
                                                                class="p-form-validation__input">
                                                        </div>
                                                    </div>
                                                    <div class="p-form__group">
                                                        <label for="bcache-name" class="p-form__label">Size</label>
                                                        <div class="p-form__controls">
                                                            <span>{$ availableNew.device.size_human $}</span>
                                                        </div>
                                                    </div>
                                                    <div class="p-form__group">
                                                        <label for="bcache-name" class="p-form__label">Type</label>
                                                        <div class="p-form__controls">
                                                            <span>Bcache</span>
                                                        </div>
                                                    </div>
                                                    <div class="p-form__group">
                                                        <label class="p-form__label">Tags</label>
                                                        <div class="p-form__controls tags--inline">
                                                            <tags-input data-ng-model="availableNew.tags" allow-tags-pattern="[\w-]+"></tags-input>
                                                        </div>
                                                    </div>
                                                    <div class="p-form__group">
                                                        <label for="cache-set" class="p-form__label">Cache set</label>
                                                        <div class="p-form__controls">
                                                            <select name="cache-set" id="cache-set"
                                                                data-ng-model="availableNew.cacheset"
                                                                data-ng-options="cacheset as cacheset.name for cacheset in cachesets">
                                                            </select>
                                                        </div>
                                                    </div>
                                                    <div class="p-form__group">
                                                        <label for="cache-mode" class="p-form__label">Cache mode</label>
                                                        <div class="p-form__controls">
                                                            <select name="cache-mode" id="cache-mode"
                                                                data-ng-model="availableNew.cacheMode">
                                                                <option value="writeback">writeback</option>
                                                                <option value="writethrough">writethrough</option>
                                                                <option value="writearound">writearound</option>
                                                            </select>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-6">
                                                    <div class="p-form__group">
                                                        <label for="type" class="p-form__label">Filesystem</label>
                                                        <div class="p-form__controls">
                                                            <select name="filesys"
                                                                data-ng-model="availableNew.fstype"
                                                                data-ng-change="fstypeChanged(availableNew)"
                                                                data-ng-options="fs.key as fs.key for fs in node.supported_filesystems">
                                                                <option value="">Unformatted</option>
                                                            </select>
                                                        </div>
                                                    </div>
                                                    <div class="p-form__group p-form-validation"
                                                        data-ng-class="{ 'is-error': isMountPointInvalid(availableNew.mountPoint) }">
                                                        <label for="mount-point" class="p-form__label">Mount point</label>
                                                        <div class="p-form__controls">
                                                            <input type="text" id="mount-point" class="p-form-validation__input"
                                                                placeholder="Absolute path"
                                                                data-ng-model="availableNew.mountPoint"
                                                                data-ng-disabled="!usesMountPoint(availableNew.fstype)">
                                                        </div>
                                                    </div>
                                                    <div class="p-form__group">
                                                        <label for="mount-options" class="p-form__label">Mount options</label>
                                                        <div class="p-form__controls">
                                                            <input type="text" id="mount-options"
                                                                placeholder="Separated by commas, no spaces"
                                                                data-ng-model="availableNew.mountOptions"
                                                                data-ng-disabled="availableNew.fstype === null">
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <table>
                                            <tr>
                                                <th class="col-2">Name</th>
                                                <th class="col-2">Size</th>
                                                <th class="col-2">Device type</th>
                                                <th class="col-6"></th>
                                            </tr>
                                            <tr>
                                                <td class="col-2">{$ availableNew.device.name $}</td>
                                                <td class="col-2">{$ availableNew.device.size_human $}</td>
                                                <td class="col-2">{$ getDeviceType(availableNew.device) $}</td>
                                                <td class="col-6"></td>
                                            </tr>
                                        </table>
                                        <div class="row">
                                            <div class="col-12 u-align--right">
                                                <button class="p-button--base"
                                                    data-ng-click="availableCancel()">Cancel</button>
                                                <button class="p-button--positive"
                                                    data-ng-disabled="!createBcacheCanSave()"
                                                    data-ng-click="availableConfirmCreateBcache()">Create bcache</button>
                                            </div>
                                        </div>
                                    </td>
                                </tr>
                                <tr class="is-active" data-ng-if="availableMode === 'raid'">
                                    <td class="col-1">
                                        <input type="checkbox" class="checkbox" id="raid-create" disabled="disabled" checked />
                                        <label for="raid-create"></label>
                                    </td>
                                    <td class="col-2 p-form-validation"
                                        data-ng-class="{ 'is-error': isNewDiskNameInvalid() }">
                                        <input type="text" class="p-form-validation__input"
                                            data-ng-model="availableNew.name">
                                    </td>
                                    <td class="col-9"></td>
                                    <td class="p-table-expanding__panel col-12">
                                        <div class="row" data-ng-if="windowWidth <= 768">
                                            <div class="col-8">
                                                <h2 data-ng-click="availableCancel()">Creating RAID</h2>
                                            </div>
                                            <div class="col-4 u-align--right">
                                                <button data-ng-click="availableCancel()" class="p-button">
                                                    <i class="p-icon--close">Cancel</i>
                                                </button>
                                            </div>
                                        </div>
                                        <div class="p-form p-form--stacked row">
                                            <div class="row">
                                                <div class="col-6">
                                                    <div class="p-form__group u-hide--large">
                                                        <label for="new-raid-name" class="p-form__label">Name</label>
                                                        <div class="p-form__controls">
                                                            <input type="text" id="new-raid-name"
                                                                data-ng-class="{ 'is-error': isNewDiskNameInvalid() }"
                                                                data-ng-model="availableNew.name">
                                                        </div>
                                                    </div>
                                                    <div class="p-form__group">
                                                        <label class="p-form__label">Size</label>
                                                        <div class="p-form__controls">
                                                            <span>{$ getNewRAIDSize() $}</span>
                                                        </div>
                                                    </div>
                                                    <div class="p-form__group">
                                                        <label for="type" class="p-form__label">RAID type</label>
                                                        <div class="p-form__controls">
                                                            <select name="type" id="type"
                                                                data-ng-model="availableNew.mode"
                                                                data-ng-change="RAIDModeChanged()"
                                                                data-ng-options="mode as mode.title for mode in getAvailableRAIDModes()">
                                                            </select>
                                                        </div>
                                                    </div>
                                                    <div class="p-form__group">
                                                        <label class="p-form__label">Tags</label>
                                                        <div class="p-form__controls tags--inline">
                                                            <tags-input data-ng-model="availableNew.tags" allow-tags-pattern="[\w-]+"></tags-input>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-6">
                                                    <div class="p-form__group">
                                                        <label for="type" class="p-form__label">File system</label>
                                                        <div class="p-form__controls">
                                                            <select name="filesys"
                                                                data-ng-model="availableNew.fstype"
                                                                data-ng-change="fstypeChanged(availableNew)"
                                                                data-ng-options="fs.key as fs.key for fs in node.supported_filesystems">
                                                                <option value="">Unformatted</option>
                                                            </select>
                                                        </div>
                                                    </div>
                                                    <div class="p-form__group p-form-validation"
                                                        data-ng-class="{ 'is-error': isMountPointInvalid(availableNew.mountPoint) }">
                                                        <label for="mount-point" class="p-form__label">Mount point</label>
                                                        <div class="p-form__controls">
                                                            <input type="text" id="mount-point" class="p-form-validation__input"
                                                                placeholder="Absolute path"
                                                                data-ng-model="availableNew.mountPoint"
                                                                data-ng-disabled="!usesMountPoint(availableNew.fstype)">
                                                        </div>
                                                    </div>
                                                    <div class="p-form__group">
                                                        <label for="mount-options" class="p-form__label">Mount options</label>
                                                        <div class="p-form__controls">
                                                            <input type="text" id="mount-options"
                                                                placeholder="Separated by commas, no spaces"
                                                                data-ng-model="availableNew.mountOptions"
                                                                data-ng-disabled="availableNew.fstype === null">
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <table>
                                                <tr>
                                                    <th class="col-2">Name</th>
                                                    <th class="col-2">Size</th>
                                                    <th class="col-2">Device type</th>
                                                    <th class="col-1">Active</th>
                                                    <th class="col-2">
                                                        <span data-ng-show="showSparesColumn()">Spare (Maximum {$ getTotalNumberOfAvailableSpares() $})</span>
                                                    </th>
                                                    <th class="col-3"></th>
                                                </tr>
                                                <tr data-ng-repeat="device in availableNew.devices">
                                                    <td class="col-2" aria-label="Name">{$ device.name $}</td>
                                                    <td class="col-2" aria-label="Size">{$ device.size_human $}</td>
                                                    <td class="col-2" aria-label="Tyoe">{$ getDeviceType(device) $}</td>
                                                    <td class="col-1" aria-label="Active">
                                                        <input type="radio" id="{$ device.name $}-active" name="{$ device.name $}-options"
                                                            data-ng-checked="isActiveRAIDMember(device)"
                                                            data-ng-click="setAsActiveRAIDMember(device)">
                                                        <label for="{$ device.name $}-active"></label>
                                                    </td>
                                                    <td class="col-2" aria-label="Spare" data-ng-show="showSparesColumn()">
                                                        <input type="radio" name="{$ device.name $}-options" id="{$ device.name $}-spare"
                                                            data-ng-checked="isSpareRAIDMember(device)"
                                                            data-ng-click="setAsSpareRAIDMember(device)"
                                                            data-ng-disabled="getNumberOfRemainingSpares() <= 0">
                                                        <label for="{$ device.name $}-spare"></label>
                                                    </td>
                                                    <td class="col-3"></td>
                                                </tr>
                                            </table>
                                        </div>
                                        <div class="row">
                                            <div class="col-12 u-align--right">
                                                <button class="p-button--base"
                                                    data-ng-click="availableCancel()">Cancel</button>
                                                <button class="p-button--positive"
                                                    data-ng-disabled="!createRAIDCanSave()"
                                                    data-ng-click="availableConfirmCreateRAID()">Create RAID</button>
                                            </div>
                                        </div>
                                    </td>
                                </tr>
                                <tr class="is-active" data-ng-if="availableMode === 'volume-group'">
                                    <div class="row">
                                        <td class="col-1">
                                            <input type="checkbox" class="checkbox" id="vg-create" disabled="disabled" checked />
                                            <label for="vg-create"></label>
                                        </td>
                                        <td class="col-2 p-form-validation"
                                            data-ng-class="{ 'is-error': isNewDiskNameInvalid() }">
                                            <input type="text" class="p-form-validation__input"
                                                data-ng-model="availableNew.name">
                                        </td>
                                        <td class="col-9"></td>
                                        <td class="p-table-expanding__panel col-12">
                                            <div class="row" data-ng-if="windowWidth <= 768">
                                                <div class="col-8">
                                                    <h2 data-ng-click="availableCancel()">Creating volume group</h2>
                                                </div>
                                                <div class="col-4 u-align--right">
                                                    <button data-ng-click="availableCancel()" class="p-button">
                                                        <i class="p-icon--close">Cancel</i>
                                                    </button>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="p-form p-form--stacked">
                                                    <div class="row">
                                                        <div class="col-6">
                                                            <div class="p-form__group p-form-validation u-hide--large">
                                                                <label for="new-vg-name" class="p-form__label">Name</label>
                                                                <div class="p-form__controls">
                                                                    <input type="text" class="p-form-validation__input" id="new-vg-name"
                                                                        data-ng-class="{ 'is-error': isNewDiskNameInvalid() }"
                                                                        data-ng-model="availableNew.name">
                                                                </div>
                                                            </div>
                                                            <div class="p-form__group">
                                                                <label for="new-vg-name" class="p-form__label">Size</label>
                                                                <div class="p-form__controls">
                                                                    <span>{$ getNewVolumeGroupSize() $}</span>
                                                                </div>
                                                            </div>
                                                            <div class="p-form__group">
                                                                <label for="new-vg-name" class="p-form__label">Type</label>
                                                                <div class="p-form__controls">
                                                                    <span>Volume group</span>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <hr />
                                                <table>
                                                    <thead>
                                                        <tr>
                                                            <th class="col-2">Name</th>
                                                            <th class="col-2">Size</th>
                                                            <th class="col-2">Device type</th>
                                                            <th class="col-6"></th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr data-ng-repeat="device in availableNew.devices">
                                                            <td class="col-2" aria-label="Name">{$ device.name $}</td>
                                                            <td class="col-2" aria-label="Size">{$ device.size_human $}</td>
                                                            <td class="col-2" aria-label="Device type">{$ getDeviceType(device) $}</td>
                                                            <td class="col-6"></td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                            <div class="row">
                                                <hr />
                                                <div class="col-12 u-align--right">
                                                    <button class="p-button--base"
                                                        data-ng-click="availableCancel()">Cancel</button>
                                                    <button class="p-button--positive u-no-margin--top"
                                                        data-ng-disabled="!createVolumeGroupCanSave()"
                                                        data-ng-click="availableConfirmCreateVolumeGroup()">Create volume group</button>
                                                </div>
                                            </div>
                                        </td>
                                    </div>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div class="row">
                        <button class="p-button--neutral p-tooltip p-tooltip--top-center"
                            data-ng-disabled="!canCreateRAID()"
                            data-ng-hide="isAllStorageDisabled() || !isSuperUser()"
                            data-ng-click="createRAID()">
                            Create RAID
                            <span class="p-tooltip__message" role="tooltip">Select two or more physical devices to create a RAID</span>
                        </button>
                        <button class="p-button--neutral p-tooltip p-tooltip--top-center"
                            data-ng-disabled="!canCreateVolumeGroup()"
                            data-ng-hide="isAllStorageDisabled() || !isSuperUser()"
                            data-ng-click="createVolumeGroup()">
                            Create volume group
                            <span class="p-tooltip__message" role="tooltip">Select one or more devices to create a volume group</span>
                        </button>
                        <button class="p-button--neutral p-tooltip p-tooltip--top-center"
                            data-ng-disabled="!canCreateCacheSet()"
                            data-ng-hide="isAllStorageDisabled() || !isSuperUser()"
                            data-ng-click="createCacheSet()">
                            Create cache Set
                            <span class="p-tooltip__message" role="tooltip">Select one device to create a cache set</span>
                        </button>
                        <button class="p-button--neutral p-tooltip--top-center"
                            data-ng-class="{ p-tooltip: !canCreateBcache() }"
                            data-ng-disabled="!canCreateBcache()"
                            data-ng-hide="isAllStorageDisabled() || !isSuperUser()"
                            data-ng-click="createBcache()">
                            Create bcache
                            <span class="p-tooltip__message" role="tooltip">{$ getCannotCreateBcacheMsg() $}</span>
                        </button>
                    </div>
                </div>
                <div class="row">
                    <h3>Used disks and partitions</h3>
                </div>
                <div class="row">
                    <table>
                        <thead>
                            <tr>
                                <th class="col-2">
                                    <a data-ng-click="tableInfo.column = 'name'" data-ng-class="{'p-link--soft': tableInfo.column === 'name'}">Name</a>
                                    <span class="divide"> | </span>
                                    <a data-ng-click="tableInfo.column = 'model'" data-ng-class="{'p-link--soft': tableInfo.column === 'model'}">Model</a>
                                    <span class="divide"> | </span>
                                    <a data-ng-click="tableInfo.column = 'serial'" data-ng-class="{'p-link--soft': tableInfo.column === 'serial'}">Serial</a>
                                </th>
                                <th class="col-2">Fireware version</th>
                                <th class="col-1"><div class="u-align--center">Boot</div></th>
                                <th class="col-2">Device type</th>
                                <th class="col-3">Used for</th>
                                <th class="col-2">Health</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr data-ng-hide="used.length">
                                <td colspan="6" class="col-12">
                                    No disk or partition has been fully utilized.
                                </td>
                            </tr>
                            <tr data-ng-repeat="item in used" class="table__row details__used">
                                <td class="col-2" aria-label="Name">
                                    <span data-ng-show="tableInfo.column === 'name'">{$ item.name $}</span>
                                    <span data-ng-show="tableInfo.column === 'model'">{$ item.model $}</span>
                                    <span data-ng-show="tableInfo.column === 'serial'">{$ item.serial $}</span>
                                </td>
                                <td class="col-2" aria-label="Firmware version">{$ item.firmware_version $}</td>
                                <td class="col-1" aria-label="Boot disk">
                                    <div class="u-align--center">
                                        <input type="radio" id="{$ item.name $}-boot" name="boot-disk"
                                            data-ng-click="setAsBootDisk(item)"
                                            data-ng-checked="item.is_boot"
                                            data-ng-if="item.type === 'physical'"
                                            data-ng-disabled="isBootDiskDisabled(item, 'used')">
                                        <label for="{$ item.name $}-boot"></label>
                                    </div>
                                </td>
                                <td class="col-2" aria-label="Device type">{$ getDeviceType(item) $}</td>
                                <td class="col-3" aria-label="Used for">{$ item.used_for $}</td>
                                <td class="col-2" aria-label="Health">
                                    <span data-ng-if="item.type === 'physical'">
                                        <span data-maas-script-status="script-status" data-script-status="item.test_status"></span>
                                        <span data-ng-if="item.test_status === 0 || item.test_status === 1 || item.test_status === 2 || item.test_status === 5 || item.test_status === 7">Ok</span>
                                        <span data-ng-if="item.test_status === 3 || item.test_status === 4 || item.test_status === 8">Error</span>
                                        <span data-ng-if="item.test_status === 6">Degraded</span>
                                        <span data-ng-if="item.test_status === -1">Unknown</span>
                                    </span>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </form>
    </section>
    <section class="p-strip" data-ng-if="section.area === 'events'">
        <div class="row">
            <div class="col-12 u-align--right" data-ng-if="node.events.length">
                <a href="#/node/{$ type_name $}/{$ node.system_id $}/events">View full history</a>
            </div>
        </div>
        <div class="row">
            <div class="col-12">
                <p data-ng-if="!node.events.length">No events.</p>
                <table data-ng-if="node.events.length">
                    <thead>
                        <tr>
                            <th class="col-9">Event</th>
                            <th class="col-3">Time</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr
                            data-ng-repeat="event in node.events | orderByDate:'created':'id' | limitTo:events.limit">
                            <td class="col-9" aria-label="Event"><span class="p-icon--{$ event.type.level $}"></span>{$ getEventText(event) $}</td>
                            <td class="col-3" aria-label="Created">{$ event.created $}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        <div class="row">
            <div class="col-12 u-align--center">
                <p>
                    <button class="p-button--neutral" data-ng-show="allowShowMoreEvents()" data-ng-click="showMoreEvents()">Load next 10 events</button>
                </p>
            </div>
        </div>
    </section>
    <section class="p-strip" data-ng-if="section.area === 'logs'">
        <div class="row">
            <div class="col-12">
                <div data-maas-cta="machine_output.views"
                    data-ng-model="machine_output.selectedView">
                </div>
            </div>
        </div>
        <div class="row" data-ng-if="machine_output.selectedView.name == 'summary_yaml'">
            <div class="col-12">
                <pre class="p-code-numbered" data-maas-code-lines="getSummaryData('yaml')">
                </pre>
            </div>
        </div>
        <div class="row" data-ng-if="machine_output.selectedView.name == 'summary_xml'">
            <div class="col-12">
                <pre class="p-code-numbered" data-maas-code-lines="getSummaryData('xml')">
                </pre>
            </div>
        </div>
        <div class="row" data-ng-if="machine_output.selectedView.name == 'installation'">
            <div class="col-12">
                <pre class="p-code-numbered" data-maas-code-lines="getInstallationData()"></pre>
            </div>
        </div>
    </section>
    <section class="p-strip" data-ng-if="section.area === 'commissioning'">
        <div data-maas-script-results-list="script-results"></div>
    </section>
    <section class="p-strip" data-ng-if="section.area === 'testing'">
        <div data-maas-script-results-list="script-results"></div>
    </section>
</div>
